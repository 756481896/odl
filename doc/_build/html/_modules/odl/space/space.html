<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>odl.space.space &mdash; odl beta documentation</title>
    
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     'beta',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="odl beta documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for odl.space.space</h1><div class="highlight"><pre>
<span class="c"># Copyright 2014, 2015 The ODL development group</span>
<span class="c">#</span>
<span class="c"># This file is part of ODL.</span>
<span class="c">#</span>
<span class="c"># ODL is free software: you can redistribute it and/or modify</span>
<span class="c"># it under the terms of the GNU General Public License as published by</span>
<span class="c"># the Free Software Foundation, either version 3 of the License, or</span>
<span class="c"># (at your option) any later version.</span>
<span class="c">#</span>
<span class="c"># ODL is distributed in the hope that it will be useful,</span>
<span class="c"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c"># GNU General Public License for more details.</span>
<span class="c">#</span>
<span class="c"># You should have received a copy of the GNU General Public License</span>
<span class="c"># along with ODL.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>

<span class="sd">&quot;&quot;&quot;Abstract vector spaces.</span>

<span class="sd">The classes in this module represent abstract mathematical concepts</span>
<span class="sd">of vector spaces. They cannot be used directly but are rather intended</span>
<span class="sd">to be subclassed by concrete space implementations. The spaces</span>
<span class="sd">provide default implementations of the most important vector space</span>
<span class="sd">operations. See the documentation of the respective classes for more</span>
<span class="sd">details.</span>

<span class="sd">Class descriptions</span>
<span class="sd">------------------</span>

<span class="sd">+--------------+-------------+----------------------------------------+</span>
<span class="sd">|Class name    |Direct       |Description                             |</span>
<span class="sd">|              |ancestors    |                                        |</span>
<span class="sd">+==============+=============+========================================+</span>
<span class="sd">|`LinearSpace` |`Set`        |**Abstract class.** A vector space over |</span>
<span class="sd">|              |             |a field (real or complex numbers)       |</span>
<span class="sd">|              |             |defining a vector-vector addition and a |</span>
<span class="sd">|              |             |scalar-vector multiplication with       |</span>
<span class="sd">|              |             |certain properties. See the article     |</span>
<span class="sd">|              |             |`Vector space`_ on Wikipedia for further|</span>
<span class="sd">|              |             |information.                            |</span>
<span class="sd">+--------------+-------------+----------------------------------------+</span>
<span class="sd">|`MetricSpace` |`LinearSpace`|**Abstract class.** A vector space with |</span>
<span class="sd">|              |             |a metric, i.e. a `dist` function        |</span>
<span class="sd">|              |             |measuring the distance between two      |</span>
<span class="sd">|              |             |vectors.                                |</span>
<span class="sd">+--------------+-------------+----------------------------------------+</span>
<span class="sd">|`NormedSpace` |`MetricSpace`|**Abstract class.** A metric space with |</span>
<span class="sd">|              |             |a `norm` function measuring the length  |</span>
<span class="sd">|              |             |a vector. The `dist` function is induced|</span>
<span class="sd">|              |             |by the norm as                          |</span>
<span class="sd">|              |             |`dist(x, y) = norm(x - y)`.             |</span>
<span class="sd">+--------------+-------------+----------------------------------------+</span>
<span class="sd">|`HilbertSpace`|`NormedSpace`|**Abstract class.** A normed space with |</span>
<span class="sd">|              |             |an inner product measuring angles       |</span>
<span class="sd">|              |             |between vectors with unit length. The   |</span>
<span class="sd">|              |             |`norm` function is induced by the inner |</span>
<span class="sd">|              |             |product by the according to             |</span>
<span class="sd">|              |             |`norm(x) = inner(x, x)`.                |</span>
<span class="sd">+--------------+-------------+----------------------------------------+</span>
<span class="sd">|`Algebra`     |`LinearSpace`|**Abstract class.** A linear space with |</span>
<span class="sd">|              |             |a vector-vector multiplication under    |</span>
<span class="sd">|              |             |which the space is closed. See the      |</span>
<span class="sd">|              |             |Algebra_ article on Wikipedia for       |</span>
<span class="sd">|              |             |further information. (Note that we      |</span>
<span class="sd">|              |             |assume commutativity and unitality.)    |</span>
<span class="sd">+--------------+-------------+----------------------------------------+</span>

<span class="sd">See also</span>
<span class="sd">--------</span>
<span class="sd">The `Set` class is defined in `odl.space.set`.</span>

<span class="sd">.. _Vector space: https://en.wikipedia.org/wiki/Vector_space#Definition</span>
<span class="sd">.. _Algebra: https://en.wikipedia.org/wiki/Associative_algebra</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c"># Imports for common Python 2/3 codebase</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="p">(</span><span class="n">unicode_literals</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span>
                        <span class="n">absolute_import</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">builtins</span> <span class="kn">import</span> <span class="nb">object</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">super</span>
<span class="kn">from</span> <span class="nn">future</span> <span class="kn">import</span> <span class="n">standard_library</span>
<span class="kn">from</span> <span class="nn">future.utils</span> <span class="kn">import</span> <span class="n">with_metaclass</span>

<span class="c"># External module imports</span>
<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABCMeta</span><span class="p">,</span> <span class="n">abstractmethod</span><span class="p">,</span> <span class="n">abstractproperty</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>

<span class="c"># ODL imports</span>
<span class="kn">from</span> <span class="nn">odl.space.set</span> <span class="kn">import</span> <span class="n">Set</span>
<span class="kn">from</span> <span class="nn">odl.utility.utility</span> <span class="kn">import</span> <span class="n">errfmt</span>

<span class="n">standard_library</span><span class="o">.</span><span class="n">install_aliases</span><span class="p">()</span>

<span class="c">#__all__ = (&#39;LinearSpace&#39;)</span>


<div class="viewcode-block" id="LinearSpace"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace">[docs]</a><span class="k">class</span> <span class="nc">LinearSpace</span><span class="p">(</span><span class="n">Set</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Abstract linear vector space.</span>

<span class="sd">    Its elements are represented as instances of the inner</span>
<span class="sd">    `LinearSpace.Vector` class.</span>

<span class="sd">    The concept of linear vector spaces in ODL is largely inspired by</span>
<span class="sd">    the `Rice Vector Library`_ (RVL).</span>

<span class="sd">    The abstract `LinearSpace` class is intended for quick prototyping.</span>
<span class="sd">    It has a number of abstract methods which must be overridden by a</span>
<span class="sd">    subclass. On the other hand, it provides automatic error checking</span>
<span class="sd">    and numerous attributes and methods for convenience.</span>

<span class="sd">    In the following, the abstract methods are explained in detail.</span>

<span class="sd">    Abstract methods</span>
<span class="sd">    ----------------</span>

<span class="sd">    `element(inp=None)`</span>
<span class="sd">    ~~~~~~~~~~~~~~~~~~~~</span>
<span class="sd">    This public method is the factory for the inner</span>
<span class="sd">    `LinearSpace.Vector` class. It creates a new element of the space,</span>
<span class="sd">    either from scratch or from an existing data container. In the</span>
<span class="sd">    simplest possible case, it just delegates the construction to the</span>
<span class="sd">    `Vector` class.</span>

<span class="sd">    If no data is provided, the new element is **merely allocated, not</span>
<span class="sd">    initialized**, thus it can contain *any* value.</span>

<span class="sd">    **Parameters:**</span>
<span class="sd">        `inp` : `object`, optional</span>
<span class="sd">            A container for values for the element initialization</span>

<span class="sd">    **Returns:**</span>
<span class="sd">        `element` : `LinearSpace.Vector`</span>
<span class="sd">            The new vector.</span>

<span class="sd">    `_lincomb(z, a, x, b, y)`</span>
<span class="sd">    ~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="sd">    This private method is the raw implementation (i.e. no error</span>
<span class="sd">    checking) of the linear combination `z &lt;-- a * x + b * y`.</span>
<span class="sd">    `_lincomb` and its public counterpart `lincomb` are used to cover</span>
<span class="sd">    a range of convenience functions, see below.</span>

<span class="sd">    **Parameters:**</span>
<span class="sd">        `z` : `LinearSpace.Vector`</span>
<span class="sd">            Element to which the result of the computation is written</span>
<span class="sd">        `a` : `LinearSpace.field` element</span>
<span class="sd">            Multiplicative scalar factor for input vector `x`</span>
<span class="sd">        `x` : `LinearSpace.Vector`</span>
<span class="sd">            First input vector</span>
<span class="sd">        `b` : `LinearSpace.field` element</span>
<span class="sd">            Multiplicative scalar factor for input vector `y`</span>
<span class="sd">        `y` : `LinearSpace.Vector`</span>
<span class="sd">            Second input vector</span>

<span class="sd">    **Returns:** `None`</span>

<span class="sd">    **Requirements:**</span>
<span class="sd">     * Aliasing of `x`, `y` and `z` **must** be allowed.</span>
<span class="sd">     * The input vectors `x` and `y` **must not** be modified.</span>
<span class="sd">     * The initial state of the output vector `z` **must not**</span>
<span class="sd">       influence the result.</span>

<span class="sd">    `field`</span>
<span class="sd">    ~~~~~~~</span>
<span class="sd">    The public attribute determining the type of scalars which</span>
<span class="sd">    underlie the space. Can be either `RealNumbers` or</span>
<span class="sd">    `ComplexNumbers` (see `odl.space.set`).</span>

<span class="sd">    Must be implemented as a `@property` to make it immutable.</span>

<span class="sd">    `equals(other)`</span>
<span class="sd">    ~~~~~~~~~~~~~~~</span>
<span class="sd">    `LinearSpace` inherits this abstract method from `Set`. Its</span>
<span class="sd">    purpose is to check two `LinearSpace` instances for equality.</span>

<span class="sd">    **Parameters:**</span>
<span class="sd">        `other` : `object`</span>
<span class="sd">            The object to compare to.</span>

<span class="sd">    **Returns:**</span>
<span class="sd">        `equals` : `boolean`</span>
<span class="sd">            `True` if `other` is the same `LinearSpace`, `False`</span>
<span class="sd">            otherwise.</span>

<span class="sd">    Optional methods</span>
<span class="sd">    ----------------</span>

<span class="sd">    `_dist(x, y)`</span>
<span class="sd">    ~~~~~~~~~~~~~</span>
<span class="sd">    A raw (not type-checking) private method measuring the distance</span>
<span class="sd">    between two vectors `x` and `y`.</span>

<span class="sd">    A space with a distance is called a Metric Space.</span>

<span class="sd">    **Parameters:**</span>
<span class="sd">        `x` : `object`</span>
<span class="sd">            The first vector</span>
<span class="sd">        `y` : `object`</span>
<span class="sd">            The second vector</span>

<span class="sd">    **Returns:**</span>
<span class="sd">        `distance` : `RealNumber`</span>
<span class="sd">            The distance between `x` and `y`, measured in the space&#39;s</span>
<span class="sd">            metric</span>

<span class="sd">    **Requirements:**</span>
<span class="sd">        * `_dist(x, y) == _dist(y, x)`</span>
<span class="sd">        * `_dist(x, y) &lt;= _dist(x, z) + _dist(z, y)`</span>
<span class="sd">        * `_dist(x, y) &gt;= 0`</span>
<span class="sd">        * `_dist(x, y) == 0` (approx.) if and only if `x == y` (approx.)</span>

<span class="sd">    `_norm(x)`</span>
<span class="sd">    ~~~~~~~~~~</span>
<span class="sd">    A raw (not type-checking) private method measuring the length of a</span>
<span class="sd">    space element `x`.</span>

<span class="sd">    A space with a norm is called a `Normed Space`.</span>

<span class="sd">    **Parameters:**</span>
<span class="sd">        `x` : `object`</span>
<span class="sd">            The vector to measure</span>

<span class="sd">    **Returns:**</span>
<span class="sd">        `norm` : `RealNumber`</span>
<span class="sd">            The length of `x` as measured in the space&#39;s metric</span>

<span class="sd">    **Requirements:**</span>
<span class="sd">     * `_norm(s * x) = |s| * _norm(x)` for any scalar `s`</span>
<span class="sd">     * `_norm(x + y) &lt;= _norm(x) + _norm(y)`</span>
<span class="sd">     * `_norm(x) &gt;= 0`</span>
<span class="sd">     * `_norm(x) == 0` (approx.) if and only if `x == 0` (approx.)</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    A `Normed Space` is a `Metric Space` with the distance function</span>
<span class="sd">    `_dist(x, y) = _norm(x - y)`.</span>


<span class="sd">    `_inner(x, y)`</span>
<span class="sd">    ~~~~~~~~~~~~~~</span>
<span class="sd">    A raw (not type-checking) private method calculating the inner</span>
<span class="sd">    product of two space elements `x` and `y`.</span>

<span class="sd">    **Parameters:**</span>
<span class="sd">        `x` : `object`</span>
<span class="sd">            The first vector</span>
<span class="sd">        `y` : `object`</span>
<span class="sd">            The second vector</span>

<span class="sd">    **Returns:**</span>
<span class="sd">        `inner` : `space.field` element</span>
<span class="sd">            The inner product of `x` and `y`</span>

<span class="sd">    **Requirements:**</span>
<span class="sd">     * `_inner(x, y) == _inner(y, x)^*` with &#39;*&#39; = complex conjugation</span>
<span class="sd">     * `_inner(s * x, y) == s * _inner(x, y)` for `s` scalar</span>
<span class="sd">     * `_inner(x + z, y) == _inner(x, y) + _inner(z, y)`</span>
<span class="sd">     * `_inner(x, x) == 0` (approx.) if and only if `x == 0` (approx.)</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    A `HilbertSpace` is a `NormedSpace` with the norm function</span>
<span class="sd">    `_norm(x) = sqrt(_inner(x, x))`, and in consequence also a</span>
<span class="sd">    `MetricSpace` with the distance function</span>
<span class="sd">    `_dist(x, y) = _norm(x - y)`.</span>


<span class="sd">    `_multiply(x, y)`</span>
<span class="sd">    ~~~~~~~~~~~~~~~~~</span>
<span class="sd">    A raw (not type-checking) private method multiplying two vectors</span>
<span class="sd">    `x` and `y`.</span>

<span class="sd">    **Parameters:**</span>
<span class="sd">        `x` : `object`</span>
<span class="sd">            First vector</span>
<span class="sd">        `y` : `object`</span>
<span class="sd">            Second vector, stores the final result</span>

<span class="sd">    **Returns:** `None`</span>

<span class="sd">    **Requirements:**</span>
<span class="sd">     * `y` after `_multiply(x, y)` equals `x` after `_multiply(y, x)`</span>
<span class="sd">     * `_multiply(s * x, y) &lt;==&gt; y *= s; _multiply(x, y)  &lt;==&gt;</span>
<span class="sd">        _multiply(x, y); y *= s` for `s` scalar</span>
<span class="sd">     * There is a space element `one` with</span>
<span class="sd">       `x` after `_multiply(one, x)` equals `x` equals `one`</span>
<span class="sd">       after `_multiply(x, one)`.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    The above conditions on the multiplication make `Algebra` a</span>
<span class="sd">    *unital commutative algebra* in the mathematical sense.</span>


<span class="sd">    Default convenience methods</span>
<span class="sd">    ---------------------------</span>
<span class="sd">    `LinearSpace` provides several default methods for convenience</span>
<span class="sd">    which use the abstract methods above. A subclass may override</span>
<span class="sd">    them with own implementations.</span>

<span class="sd">    +--------------+--------------------+-----------------------------+</span>
<span class="sd">    |Signature     |Return type         |Description                  |</span>
<span class="sd">    +==============+====================+=============================+</span>
<span class="sd">    |`lincomb(z, a,|`None`              |Linear combination           |</span>
<span class="sd">    |x, b, y)`     |                    |`z &lt;-- a * x + b * y`. Like  |</span>
<span class="sd">    |              |                    |`_lincomb()`, but with type  |</span>
<span class="sd">    |              |                    |checks.                      |</span>
<span class="sd">    +--------------+--------------------+-----------------------------+</span>
<span class="sd">    |`zero()`      |`LinearSpace.Vector`|Create a zero vector by first|</span>
<span class="sd">    |              |                    |issuing `x = element()` and  |</span>
<span class="sd">    |              |                    |then                         |</span>
<span class="sd">    |              |                    |`_lincomb(x, 0, x, 0, x)`    |</span>
<span class="sd">    +--------------+--------------------+-----------------------------+    </span>
<span class="sd">    |Metric Space methods                                             |</span>
<span class="sd">    +--------------+--------------------+-----------------------------+    </span>
<span class="sd">    |`dist(x, y)`|`float`     |Distance between two space elements.   |</span>
<span class="sd">    |            |            |Like `_dist()`, but with type checks.  |</span>
<span class="sd">    +------------+------------+---------------------------------------+</span>
<span class="sd">    |Normed Space methods                                             |</span>
<span class="sd">    +-------------+------------+--------------------------------------+</span>
<span class="sd">    |`norm(x)`    |`float`     |Length of a space element. Like       |</span>
<span class="sd">    |             |            |`_norm()`, but with type checks.      |</span>
<span class="sd">    +-------------+------------+--------------------------------------+</span>
<span class="sd">    |Hilbert Space methods                                            |</span>
<span class="sd">    +-------------+------------+--------------------------------------+</span>
<span class="sd">    |`inner(x, y)`|`field`     |Inner product of two space elements.  |</span>
<span class="sd">    |             |element     |Like `_inner()`, but with type        |</span>
<span class="sd">    |             |            |checks.                               |</span>
<span class="sd">    +-------------+------------+--------------------------------------+</span>
<span class="sd">    |Algebra       methods                                            |</span>
<span class="sd">    +----------------+-----------+------------------------------------+</span>
<span class="sd">    |`multiply(x, y)`|`None`     |Multiplication of two space         |</span>
<span class="sd">    |                |           |elements. Like `_multiply()`, but   |</span>
<span class="sd">    |                |           |with type checks.                   |</span>
<span class="sd">    +----------------+-----------+------------------------------------+</span>

<span class="sd">    Magic methods</span>
<span class="sd">    -------------</span>

<span class="sd">    +----------------------+----------------+--------------------+</span>
<span class="sd">    |Signature             |Provides syntax |Implementation      |</span>
<span class="sd">    +======================+================+====================+</span>
<span class="sd">    |`__eq__(other)`       |`self == other` |`equals(other)`     |</span>
<span class="sd">    +----------------------+----------------+--------------------+</span>
<span class="sd">    |`__ne__(other)`       |`self != other` |`not equals(other)` |</span>
<span class="sd">    +----------------------+----------------+--------------------+</span>
<span class="sd">    |`__contains__(other)` |`other in self` |`contains(other)`   |</span>
<span class="sd">    +----------------------+----------------+--------------------+</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    See Wikipedia&#39;s `Vector space`_ article for a mathematical</span>
<span class="sd">    overview.</span>

<span class="sd">    .. _`Rice Vector Library`:</span>
<span class="sd">       http://www.trip.caam.rice.edu/software/rvl/rvl/doc/html/</span>
<span class="sd">    .. _`Vector space`:</span>
<span class="sd">       https://en.wikipedia.org/wiki/Vector_space</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
<div class="viewcode-block" id="LinearSpace.element"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.element">[docs]</a>    <span class="k">def</span> <span class="nf">element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an element from `inp` or from scratch.</span>

<span class="sd">        If called without `inp` argument, an arbitrary element in the</span>
<span class="sd">        space is generated without guarantee of its state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        inp : `object`, optional</span>
<span class="sd">            The input data from which to create the element</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        element : `LinearSpace.Vector`</span>
<span class="sd">            A vector in this space</span>
<span class="sd">        &quot;&quot;&quot;</span>
</div>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">_lincomb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate z = a*x + b*y.</span>

<span class="sd">        This method is intended to be private, public callers should</span>
<span class="sd">        resort to lincomb which is type-checked.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the distance between x and y.</span>

<span class="sd">        This method is intended to be private, public callers should</span>
<span class="sd">        resort to dist which is type-checked.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#default implementation</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>

    
    <span class="k">def</span> <span class="nf">_norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the norm of x</span>

<span class="sd">        This method is intended to be private, public callers should</span>
<span class="sd">        resort to dist which is type-checked.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#default implementation</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_inner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Calculate the inner product of x and y</span>

<span class="sd">        This method is intended to be private, public callers should</span>
<span class="sd">        resort to dist which is type-checked.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#No default implementation possible</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;Inner product not implemented&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_multiply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Calculate the multiplication of z = x * y</span>

<span class="sd">        This method is intended to be private, public callers should</span>
<span class="sd">        resort to dist which is type-checked.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#No default implementation possible</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;Multiplication not implemented&quot;</span><span class="p">)</span>

    <span class="nd">@abstractproperty</span>
    <span class="k">def</span> <span class="nf">field</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The field of the vector space.&quot;&quot;&quot;</span>

    <span class="c"># Default methods</span>
<div class="viewcode-block" id="LinearSpace.zero"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.zero">[docs]</a>    <span class="k">def</span> <span class="nf">zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;A zero vector in this space.</span>

<span class="sd">        The zero vector is defined as the additive unit of a space.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        v : Vector</span>
<span class="sd">            The zero vector of this space</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Default implementation using lincomb</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lincomb</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tmp</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tmp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tmp</span>
</div>
<div class="viewcode-block" id="LinearSpace.contains"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.contains">[docs]</a>    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Test an object for membership in space.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : `object`</span>
<span class="sd">            The object to test for membership</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        contains : `bool`</span>
<span class="sd">            True if `other` is a `LinearSpace.Vector` instance and</span>
<span class="sd">            `other.space` is equal to this space.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This is the strict default where spaces must be equal.</span>
<span class="sd">        Subclasses may choose to implement a less strict check.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">LinearSpace</span><span class="o">.</span><span class="n">Vector</span><span class="p">)</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">space</span> <span class="o">==</span> <span class="bp">self</span>

    <span class="c"># Error checking variant of methods</span></div>
<div class="viewcode-block" id="LinearSpace.lincomb"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.lincomb">[docs]</a>    <span class="k">def</span> <span class="nf">lincomb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Linear combination of vectors.</span>

<span class="sd">        Calculates</span>

<span class="sd">        z = a*x</span>
<span class="sd">        or if b and y are given</span>
<span class="sd">        z = a*x + b*y</span>

<span class="sd">        with error checking of types.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        z : Vector</span>
<span class="sd">            The Vector that the result should be written to.</span>
<span class="sd">        a : Scalar in the field of this space</span>
<span class="sd">            Scalar to multiply `x` with.</span>
<span class="sd">        x : Vector</span>
<span class="sd">            The first of the summands</span>
<span class="sd">        b : Scalar, optional</span>
<span class="sd">            Scalar to multiply `y` with.</span>
<span class="sd">        y : Vector, optional</span>
<span class="sd">            The second of the summands</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Some notes and examples</span>

<span class="sd">        Alignment</span>
<span class="sd">        ~~~~~~~~~</span>
<span class="sd">        The vectors `z`, `x` and `y` may be aligned, thus a call</span>

<span class="sd">        space.lincomb(x, 2, x, 3.14, x)</span>

<span class="sd">        is (mathematically) equivalent to</span>

<span class="sd">        x = x * (1 + 2 + 3.14)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">errfmt</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">            `z` {!r} not in space {!r}.&#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">errfmt</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">            `a` {!r} not in `field` {!r} of space {!r}.</span>
<span class="s">            &#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">,</span> <span class="bp">self</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">errfmt</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">            `x` {!r} not in space {!r}.&#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>  <span class="c"># Single argument</span>
            <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;`y` provided but not `b`.&#39;</span><span class="p">)</span>

            <span class="c"># Call method</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lincomb</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c"># Two arguments</span>
            <span class="k">if</span> <span class="n">b</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">errfmt</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">                `b` {!r} not in `field` {!r} of space {!r}.</span>
<span class="s">                &#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">,</span> <span class="bp">self</span><span class="p">)))</span>

            <span class="k">if</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">errfmt</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">                `y` {!r} not in space {!r}.&#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="p">)))</span>

            <span class="c"># Call method</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lincomb</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LinearSpace.dist"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.dist">[docs]</a>    <span class="k">def</span> <span class="nf">dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the distance between two vectors.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : MetricSpace.Vector</span>
<span class="sd">            The first element</span>

<span class="sd">        y : MetricSpace.Vector</span>
<span class="sd">            The second element</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dist : RealNumber</span>
<span class="sd">               Distance between vectors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;`x` {} not in space {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">y</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;`y` {} not in space {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="LinearSpace.norm"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.norm">[docs]</a>    <span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Calculate the norm of a vector.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">vector</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;x ({}) is not in space ({})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_norm</span><span class="p">(</span><span class="n">vector</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="LinearSpace.inner"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.inner">[docs]</a>    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Calculates the inner product of the vectors x and y</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c"># Check spaces</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;x ({}) is not in space ({})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;y ({}) is not in space ({})&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="o">.</span><span class="n">element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_inner</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
    </div>
<div class="viewcode-block" id="LinearSpace.multiply"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.multiply">[docs]</a>    <span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Calculates the pointwise product of x and y and assigns it to y</span>
<span class="sd">        z = x * y</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Check spaces</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;x ({}) is in wrong space&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;y ({}) is in wrong space&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_multiply</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LinearSpace.Vector"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.Vector">[docs]</a>    <span class="k">class</span> <span class="nc">Vector</span><span class="p">(</span><span class="n">with_metaclass</span><span class="p">(</span><span class="n">ABCMeta</span><span class="p">,</span> <span class="nb">object</span><span class="p">)):</span>

        <span class="sd">&quot;&quot;&quot;Abstract `LinearSpace` element.</span>

<span class="sd">        Not intended for creation of vectors, use the space&#39;s</span>
<span class="sd">        `element()` method instead.</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>

<span class="sd">        +-------+-------------+---------------------------------------+</span>
<span class="sd">        |Name   |Type         |Description                            |</span>
<span class="sd">        +=======+=============+=======================================+</span>
<span class="sd">        |`space`|`LinearSpace`|The space to which this vector belongs |</span>
<span class="sd">        +-------+-------------+---------------------------------------+</span>

<span class="sd">        Methods</span>
<span class="sd">        -------</span>

<span class="sd">        +----------------+--------------------+-----------------------+</span>
<span class="sd">        |Signature       |Return type         |Description            |</span>
<span class="sd">        +================+====================+=======================+</span>
<span class="sd">        |`assign(other)` |`None`              |Copy the values of     |</span>
<span class="sd">        |                |                    |`other` to this vector.|</span>
<span class="sd">        +----------------+--------------------+-----------------------+</span>
<span class="sd">        |`copy()`        |`LinearSpace.Vector`|Create a (deep) copy of|</span>
<span class="sd">        |                |                    |this vector.           |</span>
<span class="sd">        +----------------+--------------------+-----------------------+</span>
<span class="sd">        |`lincomb(a, x,  |`None`              |Linear combination     |</span>
<span class="sd">        |b=None, y=None)`|                    |`a * x + b * y`, stored|</span>
<span class="sd">        |                |                    |in this vector.        |</span>
<span class="sd">        +----------------+--------------------+-----------------------+</span>
<span class="sd">        |`set_zero()`    |`None`              |Multiply this vector   |</span>
<span class="sd">        |                |                    |by zero.               |</span>
<span class="sd">        +----------------+--------------------+-----------------------+</span>
<span class="sd">        |Metric space methods                                         |</span>
<span class="sd">        +---------------+-----------+---------------------------------+</span>
<span class="sd">        |`equals(other)`|`boolean`  |Test if `other` is equal to this |</span>
<span class="sd">        |               |           |vector. Implemented as           |</span>
<span class="sd">        |               |           |`dist(other) == 0`.              |</span>
<span class="sd">        +---------------+-----------+---------------------------------+</span>

<span class="sd">        Magic methods</span>
<span class="sd">        -------------</span>

<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |Signature         |Provides syntax |Implementation           |</span>
<span class="sd">        +==================+================+=========================+</span>
<span class="sd">        |`__iadd__(other)` |`self += other` |`lincomb(self, 1, self,  |</span>
<span class="sd">        |                  |                |1, other)`               |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__isub__(other)` |`self -= other` |`lincomb(self, 1, self,  |</span>
<span class="sd">        |                  |                |-1, other)`              |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__imul__(scalar)`|`self *= scalar`|`lincomb(self, scalar,   |</span>
<span class="sd">        |                  |                |self)`                   |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__itruediv__     |`self /= scalar`|`__imul__(1.0 / scalar)` |</span>
<span class="sd">        |(scalar)`         |                |                         |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__idiv__(scalar)`|`self /= scalar`|same as `__itruediv__`   |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__add__(other)`  |`self + other`  |`x = element()`;         |</span>
<span class="sd">        |                  |                |`lincomb(x, 1, self, 1,  |</span>
<span class="sd">        |                  |                |other)`                  |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__sub__(other)`  |`self - other`  |`x = element()`;         |</span>
<span class="sd">        |                  |                |`lincomb(x, 1, self, -1, |</span>
<span class="sd">        |                  |                |other)`                  |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__mul__(scalar)` |`self * scalar` |`x = element()`;         |</span>
<span class="sd">        |                  |                |`lincomb(x, scalar,      |</span>
<span class="sd">        |                  |                |self)`                   |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__rmul__(scalar)`|`scalar * self` |`__mul__(scalar)`        |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__truediv__      |`self /= scalar`|`__mul__(1.0 / scalar)`  |</span>
<span class="sd">        |(scalar)`         |                |                         |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__div__(scalar)` |`self /= scalar`|same as `__truediv__`    |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__pos__()`       |`+self`         |`copy()`                 |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__neg__()`       |`-self`         |`x = element()`;         |</span>
<span class="sd">        |                  |                |`lincomb(x, -1, self)`   |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |Metric space methods                                         |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__eq__(other)`   |`self == other` |`equals(other)`          |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>
<span class="sd">        |`__ne__(other)`   |`self != other` |`not equals(other)`      |</span>
<span class="sd">        +------------------+----------------+-------------------------+</span>

<span class="sd">        Note that `lincomb` and `element` refer to `LinearSpace`</span>
<span class="sd">        methods.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">space</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Default initializer of vectors.</span>

<span class="sd">            All deriving classes must call this method to set space.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">LinearSpace</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">errfmt</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span>
<span class="s">                &#39;space&#39; ({}) is not a LinearSpace instance&#39;&#39;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">space</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_space</span> <span class="o">=</span> <span class="n">space</span>

        <span class="nd">@property</span>
        <span class="k">def</span> <span class="nf">space</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;The space this vector belongs to.&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_space</span>

        <span class="c"># Convenience functions</span>
<div class="viewcode-block" id="LinearSpace.Vector.assign"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.Vector.assign">[docs]</a>        <span class="k">def</span> <span class="nf">assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Assign the values of other to this vector.&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">lincomb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LinearSpace.Vector.copy"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.Vector.copy">[docs]</a>        <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Create an identical (deep) copy of this vector.&quot;&quot;&quot;</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">element</span><span class="p">()</span>
            <span class="n">result</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>
</div>
<div class="viewcode-block" id="LinearSpace.Vector.lincomb"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.Vector.lincomb">[docs]</a>        <span class="k">def</span> <span class="nf">lincomb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Assign a linear combination to this vector.</span>

<span class="sd">            Implemented as `space.lincomb(self, a, x, b, y)`.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">lincomb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LinearSpace.Vector.set_zero"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.Vector.set_zero">[docs]</a>        <span class="k">def</span> <span class="nf">set_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Set this vector to the zero vector.&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">lincomb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="c"># Convenience operators</span></div>
        <span class="k">def</span> <span class="nf">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of &#39;self += other&#39;.&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">lincomb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">def</span> <span class="nf">__isub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of &#39;self -= other&#39;.&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">lincomb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">def</span> <span class="nf">__imul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of &#39;self *= other&#39;.&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">other</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">lincomb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">def</span> <span class="nf">__itruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of &#39;self /= other&#39; (true division).&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__imul__</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">other</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">__idiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of &#39;self /= other&#39;.&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__itruediv__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of &#39;self + other&#39;.&quot;&quot;&quot;</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">element</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">lincomb</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tmp</span>

        <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of &#39;self - other&#39;.&quot;&quot;&quot;</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">element</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">lincomb</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tmp</span>

        <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of &#39;self * other&#39;.&quot;&quot;&quot;</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">element</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">other</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">lincomb</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tmp</span>

        <span class="k">def</span> <span class="nf">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of &#39;other * self&#39;.&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of &#39;self / other&#39; (true division).&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__mul__</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">other</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">__div__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of &#39;self / scalar&#39;.&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__truediv__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of &#39;-self&#39;.&quot;&quot;&quot;</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">element</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">lincomb</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">tmp</span>

        <span class="k">def</span> <span class="nf">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of &#39;+self&#39;.&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c"># Metric space method</span>
<div class="viewcode-block" id="LinearSpace.Vector.equals"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.Vector.equals">[docs]</a>        <span class="k">def</span> <span class="nf">equals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Test two vectors for equality.</span>

<span class="sd">            Two vectors are equal if their distance is 0</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>
<span class="sd">            other : MetricSpace.Vector</span>
<span class="sd">                    Vector in this space.</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            equals : boolean</span>
<span class="sd">                     True if the vectors are equal, else false.</span>

<span class="sd">            Note</span>
<span class="sd">            ----</span>
<span class="sd">            Equality is very sensitive to numerical errors, thus any</span>
<span class="sd">            operations on a vector should be expected to break equality</span>
<span class="sd">            testing.</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>

<span class="sd">            &gt;&gt;&gt; from odl.space.cartesian import Rn</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; X = Rn(1, norm=np.linalg.norm)</span>
<span class="sd">            &gt;&gt;&gt; x = X.element([0.1])</span>
<span class="sd">            &gt;&gt;&gt; x == x</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; y = X.element([0.1])</span>
<span class="sd">            &gt;&gt;&gt; x == y</span>
<span class="sd">            True</span>
<span class="sd">            &gt;&gt;&gt; z = X.element([0.3])</span>
<span class="sd">            &gt;&gt;&gt; x+x+x == z</span>
<span class="sd">            False</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">LinearSpace</span><span class="o">.</span><span class="n">Vector</span><span class="p">)</span> <span class="ow">or</span>
                    <span class="n">other</span><span class="o">.</span><span class="n">space</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">):</span>
                <span class="c"># Cannot use (if other not in self.space) since this is not</span>
                <span class="c"># reflexive.</span>
                <span class="k">return</span> <span class="bp">False</span>
            <span class="k">elif</span> <span class="n">other</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
                <span class="c"># Optimization for the most common case</span>
                <span class="k">return</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
</div>
        <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Implementation of str().&quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.Vector&quot;</span>

        <span class="c">#TODO: DECIDE ON THESE + DOCUMENT</span>
<div class="viewcode-block" id="LinearSpace.Vector.norm"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.Vector.norm">[docs]</a>        <span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LinearSpace.Vector.dist"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.Vector.dist">[docs]</a>        <span class="k">def</span> <span class="nf">dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LinearSpace.Vector.inner"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.Vector.inner">[docs]</a>        <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">inner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="LinearSpace.Vector.multiply"><a class="viewcode-back" href="../../../odl.space.html#odl.space.space.LinearSpace.Vector.multiply">[docs]</a>        <span class="k">def</span> <span class="nf">multiply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">space</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Jonas Adler.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
    </div>

    

    
  </body>
</html>