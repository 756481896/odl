\documentclass[a4paper]{paper}

% Packages
\usepackage{mathtools}
\usepackage{etoolbox}
\usepackage{amsfonts,mathrsfs}
%\usepackage{tikz-cd}
\usepackage[matrix,arrow]{xy}
\usepackage{xspace}
\usepackage{graphicx}
\usepackage{paralist}
\usepackage{hyperref} 
\hypersetup{%
    bookmarks=true,         % show bookmarks bar?
    pdfmenubar=true,       % show Acrobat's menu?
    pdffitwindow=false,     % window fit to page when opened
    pdfstartview={FitH},    % fits the width of the page to the window
    colorlinks=true,       % false: boxed links; true: colored links
    linkcolor=red,          % color of internal links
    citecolor=red,        % color of links to bibliography
    filecolor=magenta,      % color of file links
    urlcolor=cyan,           % color of external links
    pdfborder = {0,0,0}
}

\usepackage{acro}
\usepackage{extraenv}
\usepackage{cleveref}
\usepackage{todonotes}
\usepackage{float}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage{nicefrac}



% Own definitions


% Spaces
\newcommand*{\SPC}[1]{{\ensuremath{\mathscr{#1}}}}
\newcommand*{\SPCL}{\SPC{L}}
\newcommand*{\SPCX}{\SPC{X}}
\newcommand*{\SPCY}{\SPC{Y}}
\newcommand*{\SPCZ}{\SPC{Z}}

\newcommand*{\LINOP}[2]{{L(#1, #2)}}
\newcommand*{\BLINOP}[2]{{\SPCL(#1, #2)}}

\newcommand{\FIELD}{{\ensuremath{\mathbb{F}}}}
\newcommand*{\Fn}{{\ensuremath{\FIELD^n}}}
\newcommand*{\Fm}{{\ensuremath{\FIELD^m}}}
\newcommand*{\Fk}{{\ensuremath{\FIELD^k}}}
\newcommand*{\Fmxn}{{\ensuremath{\FIELD^{m \times n}}}}
\newcommand*{\Fnxn}{{\ensuremath{\FIELD^{n \times n}}}}
\newcommand*{\Fmxm}{{\ensuremath{\FIELD^{m \times m}}}}

\newcommand{\RR}{{\ensuremath{\mathbb{R}}}}
\newcommand{\CC}{{\ensuremath{\mathbb{C}}}}
\newcommand{\NN}{{\ensuremath{\mathbb{N}}}}
\newcommand{\ZZ}{{\ensuremath{\mathbb{Z}}}}


% Operators
\newcommand*{\OP}[1]{{\ensuremath{\mathcal{#1}}}}
\newcommand*{\OPP}{\OP{P}}
\newcommand*{\OPT}{\OP{T}}
\newcommand*{\OPU}{\OP{U}}
\newcommand*{\OPID}{\OP{\mathrm{Id}}}

\newcommand{\DISCOP}[1]{{\ensuremath{\mathsf{#1}}}}
\newcommand*{\DISCOPT}{\DISCOP{T}}
\newcommand*{\DISCOPU}{\DISCOP{U}}
\newcommand*{\DISCOPID}{\DISCOP{\mathrm{Id}}}

\newcommand*{\EXT}[2]{\ensuremath{E_{#1}^{#2}}}
\newcommand*{\REST}[2]{\ensuremath{R_{#1}^{#2}}}
\newcommand*{\PROJ}[2]{\ensuremath{P_{#1}^{#2}}}
\newcommand*{\COPROJ}[2]{\ensuremath{Q_{#1}^{#2}}}
\newcommand*{\RnX}{{\ensuremath{\REST{n}{\SPC{X}}}}}
\newcommand*{\RmX}{{\ensuremath{\REST{m}{\SPC{X}}}}}
\newcommand*{\RmY}{{\ensuremath{\REST{m}{\SPC{Y}}}}}
\newcommand*{\EnX}{{\ensuremath{\EXT{n}{\SPC{X}}}}}
\newcommand*{\EmX}{{\ensuremath{\EXT{m}{\SPC{X}}}}}
\newcommand*{\EmY}{{\ensuremath{\EXT{m}{\SPC{Y}}}}}
\newcommand*{\PnX}{{\ensuremath{\PROJ{n}{\SPCX}}}}
\newcommand*{\PmY}{{\ensuremath{\PROJ{m}{\SPCY}}}}
\newcommand*{\QnX}{{\ensuremath{\COPROJ{n}{\SPCX}}}}
\newcommand*{\QmY}{{\ensuremath{\COPROJ{m}{\SPCY}}}}



% Discretization
\newcommand*{\DISCR}[2]{{\ensuremath{\mathfrak{D}_{#2}(#1)}}}
\newcommand*{\DISCRnX}{\DISCR{X}{n}}
\newcommand*{\DISCRmY}{\DISCR{Y}{m}}
\newcommand*{\DISCRkZ}{\DISCR{Z}{k}}


% Useful math delimiter macros using mathtools
% A macro \CMD supports three usage types:
% 1. \CMD{<arg>}  --  standard size delimiters
% 2. \CMD[<size modifier>]{<arg>}  --  adds <size modifier> to the delimiters, e.g. \big, \Big, \bigg, \Bigg
% 3. \CMD*{<arg>}  --  adds \left and \right to the respective delimiters

% SET
% Syntax: \SET{ <element> \GIVEN <condition> }
\providecommand\GIVEN{}  % just to make sure it exists
% can be useful to refer to this outside \SET
\newcommand{\SETSYMBOL}[1][]{\nonscript\:#1\vert\nonscript\:\mathopen{}\allowbreak}
\DeclarePairedDelimiterX{\SET}[1]{\lbrace}{\rbrace}{\renewcommand \GIVEN{\SETSYMBOL[\delimsize]} #1 }

% ABS, NORM, INNER etc.
% Empty arguments are replaced with \cdot, i.e., \NORM{} is equivalent to \NORM{\:\cdot\:}
\DeclarePairedDelimiterX{\ABS}[1]{\lvert}{\rvert}{\ifblank{#1}{\:\cdot\:}{#1}}

% Syntax: \NORM{<arg>} or \NORMIN{<subscript>}{<arg>}
\DeclarePairedDelimiterX{\NORM}[1]{\lVert}{\rVert}{\ifblank{#1}{\,\cdot\,}{#1}}
\DeclarePairedDelimiterXPP{\NORMIN}[2]{}{\lVert}{\rVert}{_{#1}}{\ifblank{#2}{\,\cdot\,}{#2}}
% Shortcuts for frequently used spaces
\DeclarePairedDelimiterXPP{\NORMINX}[1]{}{\lVert}{\rVert}{_\SPCX}{\ifblank{#1}{\,\cdot\,}{#1}}
\DeclarePairedDelimiterXPP{\NORMINY}[1]{}{\lVert}{\rVert}{_\SPCY}{\ifblank{#1}{\,\cdot\,}{#1}}
\DeclarePairedDelimiterXPP{\NORMINZ}[1]{}{\lVert}{\rVert}{_\SPCZ}{\ifblank{#1}{\,\cdot\,}{#1}}
\DeclarePairedDelimiterXPP{\NORMINFn}[1]{}{\lVert}{\rVert}{_n}{\ifblank{#1}{\,\cdot\,}{#1}}
\DeclarePairedDelimiterXPP{\NORMINFm}[1]{}{\lVert}{\rVert}{_m}{\ifblank{#1}{\,\cdot\,}{#1}}

% Syntax: \INNER{<arg1>}{<arg2>} or \INNERIN{<subscript>}{<arg1>}{<arg2>}
\DeclarePairedDelimiterX{\INNER}[2]{\langle}{\rangle}{\ifblank{#1}{\:\cdot\,}{#1},\ifblank{#2}{\,\cdot\,}{\, #2}}
\DeclarePairedDelimiterXPP{\INNERIN}[3]{}{\langle}{\rangle}{_{#1}}{%
\ifblank{#2}{\:\cdot\,}{#2},\ifblank{#3}{\,\cdot\,}{\,#3}%
}
% Shortcuts for frequently used spaces
\DeclarePairedDelimiterXPP{\INNERINX}[2]{}{\langle}{\rangle}{_\SPCX}{%
\ifblank{#1}{\:\cdot\,}{#1},\ifblank{#2}{\,\cdot\,}{\,#2}%
}
\DeclarePairedDelimiterXPP{\INNERINY}[2]{}{\langle}{\rangle}{_\SPCY}{%
\ifblank{#1}{\:\cdot\,}{#1},\ifblank{#2}{\,\cdot\,}{\,#2}%
}
\DeclarePairedDelimiterXPP{\INNERINZ}[2]{}{\langle}{\rangle}{_\SPCZ}{%
\ifblank{#1}{\:\cdot\,}{#1},\ifblank{#2}{\,\cdot\,}{\,#2}%
}
\DeclarePairedDelimiterXPP{\INNERINFn}[2]{}{\langle}{\rangle}{_n}{%
\ifblank{#1}{\:\cdot\,}{#1},\ifblank{#2}{\,\cdot\,}{\,#2}%
}
\DeclarePairedDelimiterXPP{\INNERINFm}[2]{}{\langle}{\rangle}{_m}{%
\ifblank{#1}{\:\cdot\,}{#1},\ifblank{#2}{\,\cdot\,}{\,#2}%
}


% Sets and properties
\DeclareMathOperator{\RANK}{rank}
\DeclareMathOperator{\RANGE}{range}
\DeclareMathOperator{\NULL}{N}
\DeclareMathOperator{\SPAN}{span}
\DeclareMathOperator{\DIM}{dim}
\DeclareMathOperator{\DIAG}{diag}
\DeclareMathOperator{\SHOULDEQ}{{\,\stackrel{!}{=}\,}}
\DeclareMathOperator{\DEFEQ}{{\coloneqq}}
\DeclareMathOperator{\EQDEF}{{\eqqcolon}}


% Misc useful stuff
\DeclareMathOperator{\ID}{Id}
\newcommand*{\FUNCRESTR}[2]{{\ensuremath{\left. \vphantom{g_{g_g}} {#1} \right|_{#2}}}}
\newcommand*{\STACK}[2]{\genfrac{}{}{0pt}{1}{#1}{#2}}
\newcommand*{\INNERbig}[2]{\ensuremath{\big\langle #1,\,#2\big\rangle}}
\newcommand*{\INNERBig}[2]{\ensuremath{\Big\langle #1,\,#2\Big\rangle}}
\newcommand*{\INNERbigg}[2]{\ensuremath{\bigg\langle #1,\,#2\bigg\rangle}}
\newcommand*{\INNERLR}[2]{\ensuremath{\left\langle #1,\,#2\right\rangle}}
\newcommand*{\D}[0]{\ensuremath{\mathrm{d}}}
\newcommand*{\TRANSP}[1]{{\ensuremath{#1^{\mathrm{T}}}}}
\newcommand*{\HERM}[1]{{\ensuremath{#1^{\mathrm{H}}}}}
\newcommand*{\IDX}[2]{{\ensuremath{{#2}^{(#1)}}}}


\newcommand{\ie}{\textsl{i.e.}\xspace}
\newcommand{\cf}{\textsl{cf.}\xspace}
\newcommand{\eg}{\textsl{e.g.}\xspace}
\newcommand{\etc}{\textsl{e.t.c.}\xspace}
\newcommand{\wrt}{{w.r.t.}\@\xspace}


\newcommand{\vzero}{\boldsymbol{0}}
\newcommand{\ve}{\boldsymbol{e}}
\newcommand{\vf}{\boldsymbol{f}}
\newcommand{\vg}{\boldsymbol{g}}
\newcommand{\valpha}{\boldsymbol{\alpha}}
\newcommand{\vbeta}{\boldsymbol{\beta}}
\newcommand{\vnu}{\boldsymbol{\nu}}
\newcommand{\vA}{\boldsymbol{A}}
\newcommand{\vB}{\boldsymbol{B}}
\newcommand{\vD}{\boldsymbol{D}}
\newcommand{\vG}{\boldsymbol{G}}
\newcommand{\vI}{\boldsymbol{I}}
\newcommand{\vU}{\boldsymbol{U}}
\newcommand{\vV}{\boldsymbol{V}}
\newcommand{\vSigma}{\boldsymbol{\Sigma}}

\newcommand{\cF}{\mathcal{F}}

\newcommand*{\NOTE}[2][\null]{%
  \marginpar{\renewcommand{\baselinestretch}{1}\vspace{-1em}\hrule\vspace{3pt}%
  \scriptsize\raggedright\textsf{#2\ifx#1\null\else\\\hfill---
  {\em #1}\fi}\vspace{1.5em}}%
}

\newcommand{\ext}{\text{ext}}
\newcommand{\wt}[1]{\widetilde{#1}}

\crefname{equation}{}{}
\Crefname{equation}{}{}
\crefname{item}{}{}
\Crefname{item}{}{}

\title{The discretization problem and associated software type system}
\author{Ozan \"Oktem \and Holger Kohr}

\begin{document}
\maketitle





\section{Introduction}
\label{sec:intro}
%
In many applications one works with mappings between infinite-dimensional vector spaces.
To numerically deal with such mappings, one is forced to find a finite-dimensional 
counterpart. The process of mapping a vector space to a finite-dimensional one is called
\emph{discretization}. A discretization of a specific space is intimately 
tied to the numerical methodology that one eventually wishes to use. However, many concepts
and results about discretizations can be stated in a general mathematical framework.  

Most complex numerical software packages work with several different discretizations, even
of the same vector space. The general mathematical theory that formalizes the process of
discretization yields consistency checks and recipes for how to switch between two
discretizations. Still, most numerical software packages do not utilize such consistency
checks and, even though changes between two discretizations are explicitly coded, this
code is often scattered throughout or even repeated in different parts of the software package.  

To minimize software bugs, it is therefore desirable to be able to abstract and isolate those parts 
of the code that deal with the discretization. To achieve this, the software must be able to represent 
the abstract process of discretization, and an object oriented framework appears to be most
suitable. We will in this note describe those parts of the abstract mathematical theory that
need to be captured by a numerical software package in able to achieve the above stated goals.
We start by giving the basic mathematical foundations.

In many cases, such as inverse problems arising in applications, one has to deal with 
the following problem: Let $\SPCX$ and $\SPCY$ be infinite-dimensional vector spaces and 
$\OPT \colon \SPCX \to \SPCY$. Consider now the following problem:
%
\begin{equation}
 \label{eq:intro:operator_eq}
 \text{Given $g\in \SPCY$, find $f\in \SPCX$ such that}\quad \OPT(f)=g. 
\end{equation}
%
The operator $\OPT$ can either be given explicitly by a closed form expression, or it can be defined 
implicitly, \eg, as a solution operator to a differential equation. 

In order to numerically work with \cref{eq:intro:operator_eq} in a software package, one must replace the 
infinite-dimensional vector spaces $\SPCX$ and $\SPCY$ with some finite-dimensional 
counterparts $\Fn$ and $\Fm$ with $\FIELD = \RR \text{ or } \CC$, and the map 
$\OPT \colon \SPCX \to \SPCY$ with an appropriate discretized operator 
$\DISCOPT_{m,n}$. This process yields the following system of (linear or nonlinear) equations
with finitely many unknowns:
%
\begin{equation}
 \label{eq:intro:discr_operator_eq}
 \text{Given $\vbeta \in \Fm$, find $\valpha \in \Fn$ such that }\quad \DISCOPT_{n,m} (\valpha)=\vbeta. 
\end{equation}
%
The above process of replacing \cref{eq:intro:operator_eq} with \cref{eq:intro:discr_operator_eq} is referred to 
as \emph{discretization} of \cref{eq:intro:operator_eq}. A general theory of discretizations is outlined in 
\cite[Chapter~34]{ZeIIB85}, see also \cite{Pe93}, but the results are of little use for ill-posed inverse 
problems since the discretized problem \cref{eq:intro:discr_operator_eq} does not fulfill the requirements.
\emph{In this note we only consider a discretization of \cref{eq:intro:operator_eq} as a way of reducing an equation in 
infinite-dimensional setting to an equation \cref{eq:intro:discr_operator_eq} in a finite-dimensional setting.}
Thus, we now formally introduce the notion of discretization in different contexts along with elementary properties.





\section{General definition of discretization}
\label{sec:discr}



\subsection{Discretization of vector spaces}
\label{subsec:discr:space}

We start out by defining the discretization of a (infinite-dimensional) vector space with the help of 
reduction and extension operators.

\begin{definition}
 \label{def:discr:space:space_discr}
 Let $\SPCX$ be a vector space over a field $\FIELD = \RR \text{ or } \CC$, and $n \in \NN$.
 An \emph{$n$-dimensional discretization $\DISCRnX$ of $\SPCX$} is the tuple
 %
 \begin{equation*}
  \DISCRnX \DEFEQ  \bigl( \SPCX, \Fn, \RnX, \EnX \bigr) 
 \end{equation*}
 %
 where $\RnX \colon \SPCX \to \Fn$ and $\EnX \colon \Fn \to \SPCX$. The mappings $\RnX$ and $\EnX$ 
 are called the \emph{restriction} and \emph{extension} operators associated with the discretization. 
 $\DISCRnX$ is a \emph{linear discretization} whenever both these mappings are linear.\\
 %
 There are two additional important mappings derived from $\RnX$ and $\EnX$,
 %
 \begin{align*}
  & \PnX \colon \SPCX \to \SPCX \quad \text{with} \quad \PnX \DEFEQ  \RnX \circ \EnX, \\
  & \QnX \colon \Fn \to \Fn \quad \text{with} \quad \QnX \DEFEQ  \EnX \circ \RnX,
 \end{align*}
 %
 which we refer to as \emph{projection} operators associated with the discretization (although they are not 
necessarily  projections in the strict sense).
\end{definition}

\begin{examp}
 We begin with considering the case where $\SPCX$ is an $n$-dimensional vector space over $\FIELD$. Then $\SPCX$ is 
 isomorphic to $\Fn$, so we may choose $\EnX \DEFEQ \RnX\DEFEQ \OPID$. The resulting discretization 
 $( \Fn, \Fn, \OPID, \OPID )$ is called 
 the \emph{identity discretization}. 
\end{examp}

\begin{examp}
 Another common discretization for an $n$-dimensional vector space $\SPCX$ is to consider a basis 
 $B\DEFEQ \SET{\psi_1,\dots, \psi_{n}}$ of $\SPCX$. Any element $f \in \SPCX$ can then be written as 
 $f = \sum_{i=1}^n \alpha_i \psi_i$ for unique $\valpha(f) = (\alpha_1, \dots, \alpha_{n})\in\Fn$, so we define
 %
 \begin{equation*}
  \RnX(f) \DEFEQ  \valpha(f) \quad \text{and} \quad \EnX(\beta) \DEFEQ  \sum_{i=1}^n \beta_i \psi_i. 
 \end{equation*}
 %
 The resulting discretization $( \SPCX, \Fn, \RnX, \EnX )$ is called the \emph{standard discretization \wrt 
 the basis $B$}. The projection operators are given by
 %
 \begin{equation*}
  \PnX(f) \DEFEQ  \sum_{i=1}^n \valpha_i(f)\, \psi_i \quad \text{and} \quad \QnX(\beta) \DEFEQ  \vbeta
 \end{equation*}

\end{examp}

\begin{examp}
 A common way to discretize a (possibly infinite-dimensional) vector space $\SPCX$ is as follows. Let 
 $\psi_1, \dots, \psi_n \in \SPCX$ be linearly independent space elements and 
 $\lambda_1, \dots, \lambda_n \in \SPCX^*$ be linearly independent functionals on $\SPCX$. Then, restriction and 
 extension operators can be defined as
 %
 \begin{equation*}
  \RnX(f) \DEFEQ  \big( \lambda_1(f), \dots, \lambda_n(f) \big) 
  \quad \text{and} \quad
  \EnX(\valpha) \DEFEQ  \sum_{i=1}^n \alpha_i\, \psi_i.
 \end{equation*}
 %
 The corresponding projection operators are
 %
 \begin{equation*}
  \PnX(f) \DEFEQ  \sum_{i=1}^n \lambda_i(f)\, \psi_i
  \quad \text{and} \quad
  \EnX(\valpha) \DEFEQ  \bigg( \sum_{j=1}^n \alpha_j\, \lambda_i(\psi_j) \bigg)_{i=1}^n.
 \end{equation*}

\end{examp}


\subsubsection{Discretization of product spaces}
\label{subsubsec:discr:space:prod}

In mathematics it is rather common to construct a new vector space from a collection of vector spaces. If the vector 
spaces in this collection all have discretizations, then one can use these discretizations to define a natural 
discretization on the aforementioned new vector space.

\begin{definition}
 \label{def:discr:space:prod:prod_space_discr}
 Let $\SPCX_i$ for $i=1,\dots,k$ be vector spaces over $\FIELD$ with $n_i$-dimensional discretizations 
 $\DISCR{\SPCX_i}{n_i}$ given as
 %
 \begin{equation*}
  \DISCR{\SPCX_i}{n_i} \DEFEQ  \bigl( \SPCX_i, \FIELD^{n_i}, \REST{n_i}{\SPCX_i}, \EXT{n_i}{\SPCX_i} \bigr). 
 \end{equation*}
 %
 Then the \emph{product discretization of $\SPCX \DEFEQ  \SPCX_1 \times \dots \times \SPCX_k$} is defined as 
 %
 \begin{equation*}
  \DISCR{\SPCX}{N} \DEFEQ \{\SPCX, \FIELD^N, \REST{N}{\SPCX}, \EXT{N}{\SPCX} \}
 \end{equation*}
 %
 with $N \DEFEQ  n_1 + \dots + n_k$, where
 %
 \begin{align*}
  \REST{N}{\SPCX}(f_1,\dots,f_k) &\DEFEQ  \bigl( \REST{n_1}{\SPCX_1}(f_1),\dots,\REST{n_k}{\SPCX_k}(f_k) \bigr)
  \quad\text{for $f_i\in \SPCX_i$, $i=1,\dots,k$} \\
  \EXT{N}{\SPCX}(f_1,\dots,f_k) &\DEFEQ  \bigl( \EXT{n_1}{\SPCX_1}(\valpha_1),\dots,\EXT{n_k}{\SPCX_k}(\valpha_k) 
  \bigr)
  \quad\text{for $\valpha_i\in \FIELD^{n_i}$, $i=1,\dots,k$.}
 \end{align*}
\end{definition}

%
Common special cases of product discretizations are $\SPCX\DEFEQ \FIELD \times \SPCX_2$, which corresponds to the 
case 
$k=2$ and $\SPCX_1=\FIELD$ with the identity discretization.



\subsection{Natural discretization of operators}
\label{subsec:discr:operator}

When given an operator $\OPT$ between vector spaces $\SPCX$ and $\SPCY$, each with a given discretization, 
there is a natural discretized counterpart $\DISCOPT \colon \Fn \to \Fm$ defined as follows:

\begin{definition}
 \label{def:discr:operator:operator_discr}
 Let $\OPT\colon \SPCX \to \SPCY$ be an operator and $\DISCRnX$ and $\DISCRmY$ be 
 discretizations of the vector spaces as in \Cref{def:discr:space:space_discr}. The 
 \emph{natural operator discretization of $\OPT$} is defined as $\DISCOPT \colon \Fn \to \Fm$ given as 
 $\DISCOPT \DEFEQ  \RmY \circ \OPT \circ \EnX$.
\end{definition}


\subsubsection{Natural discretization of spaces of linear operators}
\label{subsubsec:discr:operator:linop_space}

The above notion of a natural operator discretization immediately induces a natural discretization of the space of 
linear operators from $\SPCX$ to $\SPCY$.

\begin{definition}
 \label{def:discr:operator:linop_space:linop_space_discr}
 Let $\SPCX$ and $\SPCY$ be vector spaces with discretizations $\DISCRnX$ and $\DISCRmY$ 
 as in \Cref{def:discr:space:space_discr}. Let further $\SPCL \DEFEQ  \LINOP{\SPCX}{\SPCY}$ be the 
 vector space of linear operators from $\SPCX$ to $\SPCY$. The \emph{natural discretization of $\SPCL$} is 
 given by
 %
 \begin{equation*}
  \DISCR{\SPCL}{m\times n} = \left( \SPCL, \Fmxn, \REST{m\times n}{\SPCL}, \EXT{m\times n}{\SPCL}
  \right)
 \end{equation*}
 %
 with the operators
 %
 \begin{equation*}
  \REST{m\times n}{\SPCL}(\OPT) \DEFEQ  \RmY \circ \OPT \circ \EnX
  \quad\text{and}\quad
  \EXT{m\times n}{\SPCL}(\DISCOPT) \DEFEQ  \EmY \circ \DISCOPT \circ \RnX.
 \end{equation*}
 %
 We have here identified a linear operator from $\Fn$ to $\Fm$ with $\Fmxn$, the vector space 
 of $(m \times n)$ matrices with elements in $\FIELD$.
\end{definition}

\begin{remark}
 From the above considerations it becomes clear that it only makes sense to apply linear discretizations since 
 otherwise, the discretization of a linear operator is not necessary linear. \textbf{Hence, from now on, all 
 discretizations are assumed to be linear.}\\
 %
 Furthermore, a direct application of the same technique to the space of general (nonlinear) operators is not possible 
 since the same operator $\REST{m\times n}{\SPCL}$ would produce nonlinear mappings $\Fn \to \Fm$, which is 
 not compatible to our definition of space discretizations, \cf \Cref{def:discr:space:space_discr}.
\end{remark}


\subsubsection{Natural discretization of operator derivatives}
\label{subsubsec:discr:operator:op_deriv}

For $k \in \NN$, the $k$'th Fr\'{e}chet derivative of a $k$ times continuously differentiable operator 
$\OPT \colon \SPCX \to \SPCY$ is defined as a mapping
%
\begin{equation*}
 \partial^k \OPT \colon \SPCX \to \SPCL^k(\SPCX, \SPCY),
\end{equation*}
%
where $\SPCL^k$ is recursively defined as 
%
\begin{equation*}
 \SPCL^0(\SPCX, \SPCY) \DEFEQ  \SPCY, \quad 
 \SPCL^k(\SPCX, \SPCY) \DEFEQ  \SPCL\big( \SPCX, \SPCL^{k-1}(\SPCX, \SPCY) \big).
\end{equation*}
%
This recursion can be resolved by setting
%
\begin{equation*}
 \bar\partial^k \OPT \colon \SPCX \times \SPCX^k \to \SPCY
 \quad \text{with} \quad
 \bar\partial^k \OPT(f; h_1, \dots, h_k) \DEFEQ  \partial^k\OPT(f)(h_1)\cdots(h_k).
\end{equation*}
%
By definition, $\bar\partial^k\OPT$ is $k$-linear in the last $k$ arguments. We adopt this viewpoint in the following 
and write $\partial^k$ instead of $\bar\partial^k$.\\
%
The natural discretization of a product space as given in \Cref{def:discr:space:prod:prod_space_discr} induces a 
natural discretization of the $k$'th derivative similar to the natural operator discretization in 
\Cref{def:discr:operator:operator_discr}.

\begin{definition}
 \label{def:discr:operator:op_deriv:operator_deriv_discr}
 Let $\SPCX$ and $\SPCY$ be normed vector spaces with discretizations $\DISCRnX$ and $\DISCRmY$, 
 respectively. Let further $\OPT \in \BLINOP{\SPCX}{\SPCY}$ be a $k$ times continuously Fr\'{e}chet 
 differentiable operator for some $k \in  \NN$. The \emph{natural discretization of the $k$'th derivative} 
 $\partial^k \OPT \colon \SPCX \times \SPCX^k \to \SPCY$ is defined as the mapping
 %
 \begin{equation*}
  \partial^k \DISCOPT \colon \Fn \times \FIELD^{k\cdot n} \to \Fm
  \quad \text{with} \quad
  \partial^k \DISCOPT = \RmY \circ \partial^k \OPT \circ (\EnX)^{k+1}.
 \end{equation*}
 %
 The notation $(\EnX)^{k+1}$ stands for the $(k+1)$-tuple $(\EnX, \dots, \EnX)$, i.e., 
 %
 \begin{equation*}
  \partial^k \OPT \circ (\EnX)^{k+1}(\valpha; \vbeta_1, \dots, \vbeta_k) \DEFEQ 
 \partial^k \OPT\big( \EnX(\valpha); \EnX(\vbeta_1), \dots, \EnX(\vbeta_k) \big).
 \end{equation*}
\end{definition}


The following lemma shows that under rather weak conditions on the mappings $E_n^{\SPCX}$ and $R_m^{\SPCY}$, the 
natural discretization of the operator derivative as in \Cref{def:discr:operator:op_deriv:operator_deriv_discr} is in 
fact the Fr\'{e}chet derivative of the natural operator discretization.


\begin{lemma}
 \label{lemma:discr:operator:op_deriv:natural_is_deriv}
 Let $\SPCX$ and $\SPCY$ be normed vector spaces with discretizations as before, and let 
 $\OPT \in \BLINOP{\SPCX}{\SPCY}$ be a $k$ times continuously Fr\'{e}chet differentiable 
 operator. If $E_n^{\SPCX}$ and $R_m^{\SPCY}$ are bounded, the natural discretization $\DISCOPT$ of $\OPT$ is 
 $k$ times  continuously Fr\'{e}chet differentiable, and its $k$'th Fr\'{e}chet derivative is the natural 
 discretization of $\partial^k\OPT$.
\end{lemma}
\vspace{1em}


\begin{proof}
 We prove the claim for $k=1$ since the statement for $k=0$ is trivial, and higher order derivatives follow by 
 induction.\\
 %
 For $\valpha,\vbeta \in \Fn$, it is
 %
 \begin{equation*}
  \DISCOPT(\valpha + \vbeta) = \RmY \circ \OPT \circ \EnX (\alpha + \beta).
 \end{equation*}
 %
 From the definition of $\partial \OPT$ it follows that
 %
 \begin{align*}
  \OPT\big(\EnX(\valpha + \vbeta)\big)
  &= \OPT\big(\EnX(\valpha)\big) + \partial\OPT\big(\EnX(\valpha)\big)\big(\EnX(\vbeta)\big) +
  o\big(\NORMINX[\big]{\EnX(\vbeta)}\big) \\
  &= \OPT \circ \EnX(\valpha) + \partial\OPT\circ (\EnX)^2\,(\valpha; \vbeta) + o\big(\NORMINFn{\vbeta} \big)
 \end{align*}
 %
 for $\NORMINFn{\vbeta} \to 0$ since $\EnX$ is a bounded operator. By composing from left with the bounded operator 
 $\RmY$, one gets
 %
 \begin{align*}
  \DISCOPT(\valpha + \vbeta)
  &= \RmY \circ \OPT \circ \EnX(\valpha) + \RmY \circ \partial\OPT\circ (\EnX)^2\,(\valpha)(\vbeta) +
  o\big(\NORMINFn{\vbeta} \big) 
  \\
  &= \DISCOPT(\alpha) + \RmY \circ \partial\OPT\circ (\EnX)^2\,(\valpha)(\vbeta) + o\big(\NORMINFn{\vbeta} \big),
 \end{align*}
 %
 hence $\partial\DISCOPT$ is by definition given by the second term.
\end{proof}


\subsubsection{Natural discretization of the adjoint}
\label{subsubsec:discr:operator:op_adj}

If $\SPCX$ and $\SPCY$ are Hilbert spaces over the same field, one can consider the adjoint operator 
$\OPT^* \colon \SPCY \to \SPCX$ and its natural discretization. The following lemma clarifies under which 
conditions this discretization is the adjoint of the operator discretization $\DISCOPT$.


\begin{lemma}
 \label{lemma:discr:operator:op_adj:natural_is_adj}
 Let $\SPCX$ and $\SPCY$ are Hilbert spaces with linear discretizations as in 
 \Cref{def:discr:space:space_discr}, and let $\OPT \colon \SPCX \to \SPCY$ be a bounded linear operator. 
 Then the natural discretization of $\OPT^*$ given by
 %
 \begin{equation*}
  \DISCOPT^* \colon \Fm \to \Fn
  \quad \text{with} \quad
  \DISCOPT^* \DEFEQ  \RnX \circ \OPT^* \circ \EmY
 \end{equation*}
 %
 is the adjoint of the natural discretization $\DISCOPT \DEFEQ  \RmY \circ \OPT \circ \EnX$ of $\OPT$ if the 
operators 
 $\EnX$ and $\RmY$ are bounded and additionally satisfy
 %
 \begin{equation*}
  \EnX = (\RnX)^* \quad \text{and} \quad \EmY = (\RmY)^*.
 \end{equation*}
\end{lemma}
\vspace{1em}


\begin{proof}
 Since $\EnX$ and $\RmY$ are bounded and linear, the same is true for $\DISCOPT$. Its adjoint is given by
 %
 \begin{equation*}
  \DISCOPT^* = (\RmY \circ \OPT \circ \EnX)^* = (\EnX)^* \circ \OPT^* \circ (\RmY)^*,
 \end{equation*}
 %
 which is apparently equal to the natural discretization $\RnX \circ \OPT^* \circ \EmY$ of $\OPT^*$ under the 
 stated conditions.
\end{proof}

\begin{remark}
 This statement can be generalized to densely defined linear operators since a unique adjoint exists also for this 
 class of operators. Another possible generalization is to dual pairings and instead of Hilbert spaces. The same rules 
 as above apply for these operators when chained with bounded linear operators from left or right.
\end{remark}


\subsubsection{Natural discretization of compositions}
\label{subsubsec:discr:operator:op_comp}

Mappings or operators can be chained if their domains and ranges are compatible. We investigate how the natural 
discretization of an operator composition relates to the composition of the single discretized operators.


\begin{lemma}
 \label{lemma:discr:operator:op_comp:natural_is_comp}
 Let $\SPCX, \SPCY$ and $\SPCZ$ be vector spaces with discretizations $\DISCRnX$, 
 $\DISCRmY$ and $\DISCRkZ$, respectively. Let further
 %
 \begin{equation*}
  \OPT \colon \SPCX \to \SPCY \quad \text{and} \quad \OPU \colon \SPCY \to \SPCZ
 \end{equation*}
 %
 be given operators. The natural discretization
 %
 \begin{equation*}
  \DISCOP{S}\colon \Fn \to \Fk 
  \quad \text{with} \quad
  \DISCOP{S} \DEFEQ  \REST{k}{\SPCZ} \circ \OPU \circ \OPT \circ \EnX
 \end{equation*}
 %
 of the operator composition $\OPU \circ \OPT$ is equal to the composition of the discretized operators
 %
 \begin{equation*}
  \DISCOPT \DEFEQ  \RmY \circ \OPT \circ \EnX
  \quad \text{and} \quad
  \DISCOPU = \REST{k}{\SPCZ} \circ \OPU \circ \EmY
 \end{equation*}
 %
 if either the operator $\PmY = \EmY \circ \RmY$ is the identity on the range of $\OPT \circ \EnX$ or if for each 
 $\vnu \in \Fk$, the preimage $(\REST{k}{\SPCZ} \circ \OPU)^{-1}(\{\vnu\})$ is invariant under 
 $\PmY$.
\end{lemma}
\vspace{1em}


\begin{proof}
 Obviously, it is
 %
 \begin{equation*}
  \DISCOPU \circ \DISCOPT = \REST{k}{\SPCZ} \circ \OPU \circ \EmY \circ \RmY \circ \OPT \circ \EnX,
 \end{equation*}
 %
 which is equal to $\DISCOP{S}$ as defined above if the factor $\PmY = \EmY \circ \RmY$ can be dropped. This is the 
 case under the given condition as shown in the proof of \Cref{lemma:prop:corresp:natural_op_discr_corresp}.
\end{proof}



\subsection{Correspondence principle}
\label{subsec:discr:corresp}

We proceed by investigating conditions that a discretization should fulfill. Often, we need to perform various 
operations on $\SPCX$, and there are corresponding operations on $\Fn$. It is then important that such 
operations are compatible \wrt the discretization. In the general setting, most of these operations can be stated as 
mappings between appropriately chosen vector spaces. Thus, we begin with defining the notion of compatibility of 
mappings \wrt discretizations. 
%
\begin{definition}
 \label{def:discr:corresp:operator_compat}
 Let $\SPCX$ and $\SPCY$ be vector spaces over $\FIELD$ with discretizations $\DISCRnX$ and 
 $\DISCRmY$, respectively. Now, consider the operators
 %
 \begin{equation*}
  \OPT \colon \SPCX \to \SPCY \quad\text{and}\quad \DISCOPT \colon \Fn \to \Fm.
 \end{equation*}
 \vspace{-2\baselineskip}
 \begin{enumerate}[(a)]
  \item \label{def:discr:corresp:operator_compat:a_exact}
  \emph{$\DISCOPT$ exactly corresponds to $\OPT$ under the discretizations $\DISCRnX$ and  
  $\DISCRmY$} if the following holds for any $n,m \in \NN$:
  %
  \begin{equation*}
   \RmY \circ \OPT = \DISCOPT \circ \RnX  \quad\text{and}\quad  \EmY \circ \DISCOPT = \OPT \circ \EnX.
  \end{equation*}

  \item \label{def:discr:corresp:operator_compat:b_approx}
  \emph{$\DISCOPT$ approximately corresponds to $\OPT$ under the discretizations $\DISCRnX$ and 
  $\DISCRmY$} if the following holds:
  %
  \begin{align*} 
   \lim_{n,m\to \infty} \NORMINFm*{\RmY \circ \OPT - \DISCOPT \circ \RnX} &= 0  \\[0.5em]
   \lim_{n,m\to \infty} \NORMINY*{\EmY \circ \DISCOPT - \OPT \circ \EnX} &= 0.
  \end{align*}
  %
 \end{enumerate}  
 If any of the above holds, then we say that $\DISCOPT$ and $\OPT$ \emph{correspond to each other under the 
 discretizations $\DISCRnX$ and $\DISCRmY$}.
\end{definition}



\subsection{Summary}
\label{subsec:discr:summary}

Let $\FIELD = \RR \text{ or } \CC$ and $m, n, k \in \NN$. We investigated various settings of (natural) 
discretizations as summarized in \Cref{tab:discr:summary:def_summary}.
%
\begin{table}[ht]
 \label{tab:discr:summary:def_summary}
 \renewcommand{\arraystretch}{1.3}
 \begin{tabular}{lll}
  \textbf{Object} & \textbf{(Natural) Discretization} & \textbf{Defined in}                                           \\
  %
  %
  \noalign{\smallskip} \hline\hline \noalign{\smallskip}
  %
  %
  Vector space             & $\DISCRnX = (\SPCX, \Fn, \RnX, \EnX)$                                   & 
  \Cref{def:discr:space:space_discr}                                                                                  \\
  $\SPCX$ over $\FIELD$  & $\RnX \colon \SPCX \to \Fn$ linear                                               &\\
                           & $\EnX \colon \Fn \to \SPCX$ linear                                               &\\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Product space            & $\DISCR{\SPCX}{N} = (\SPCX, \FIELD^N, \REST{N}{\SPCX}, \EXT{N}{\SPCX})$          & 
  \Cref{def:discr:space:prod:prod_space_discr}                                                                        \\
  $\SPCX = \bigotimes_{i=1}^k \SPCX_i$ & $N = \sum_{i=1}^k n_i$                                                  &\\
                           & $\REST{N}{\SPCX} = \big( \REST{n_1}{\SPCX_1}, \dots, \REST{n_k}{\SPCX_k} \big)$  &\\
                           & $\EXT{N}{\SPCX} = \big( \EXT{n_1}{\SPCX_1}, \dots, \EXT{n_k}{\SPCX_k} \big)$     &\\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Operator $\OPT \colon \SPCX \to \SPCY$  & $\DISCOPT \colon \Fn \to \Fm$            
  & \Cref{def:discr:operator:operator_discr}                                                                          \\
                           & $\DISCOPT = \RmY \circ \OPT \circ \EnX$                                             &\\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Vector space of         & $\DISCR{\SPCL}{m\times n} = (\SPCL, \Fmxn, \REST{m\times n}{\SPCL},
  \EXT{m\times n}{\SPCL})$ & \Cref{def:discr:operator:linop_space:linop_space_discr}                                \\
  linear operators        & $\Fmxn \simeq L(\Fn, \Fm)$                                        &\\
  $\SPCL = \LINOP{\SPCX}{\SPCY}$ & $\REST{m\times n}{\SPCL}(\OPT) = \RmY \circ \OPT \circ \EnX$               &\\
                          & $\EXT{m\times n}{\SPCL}(\DISCOPT) = \EmY \circ \DISCOPT \circ \RnX$                &\\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Fr\'{e}chet derivative & $\partial^k\DISCOPT \colon \Fn \times \FIELD^{k\cdot n} \to \Fm$              & 
  \Cref{def:discr:operator:op_deriv:operator_deriv_discr}                                                             \\
  $\partial^k \OPT \colon \SPCX\times \SPCX^k \to \SPCY$ & 
  $\partial^k\DISCOPT = \RmY \circ \partial^k \OPT \circ (\EnX)^{k+1}$                                           &\\
                         & $(\EnX)^{k+1} = (\underbrace{\EnX, \dots, \EnX}_{k+1 \text{ operators }})$                \\
  %
  %
  \noalign{\smallskip} \hline\hline \noalign{\smallskip}
  %
  %
  Correspondence of & $\RmY \circ \OPT = \DISCOPT \circ \RnX$ & \Cref{def:discr:corresp:operator_compat} \\
  $\OPT \colon \SPCX \to \SPCY$ and & $\EmY \circ \DISCOPT = \OPT \circ \EnX$                              &\\
  $\DISCOPT \colon \Fn \to \Fm$  &  &                                                                     \\
  %
  %
  \noalign{\smallskip} \hline
 \end{tabular}
 \caption{Summary of definitions in \Cref{sec:discr}}
 \renewcommand{\arraystretch}{1.0}
\end{table}





\section{Mathematical properties of discretizations}
\label{sec:prop}



\subsection{Correspondence}
\label{subsec:prop:corresp}

In the following Lemma, we investigate under which conditions the natural discretization of an operator leads to 
compatibility in the sense of \Cref{def:discr:corresp:operator_compat}. These conditions can be stated more 
specifically in special cases, see \Cref{sec:specif}.


\begin{lemma}
 \label{lemma:prop:corresp:natural_op_discr_corresp}
 Let $\DISCOPT$ be the natural linear discretization of an operator $\OPT$ based on linear space discretizations as 
 in \Cref{def:discr:space:space_discr}, and let $\PnX = \EnX \circ \RnX$ and $\PmY = \EmY \circ \RmY$ as in 
 \Cref{def:discr:space:space_discr}. Then the following holds:
 
 \begin{enumerate}[(a)]
  \item \label{lemma:prop:corresp:natural_op_discr_corresp:a_general}
  $\DISCOPT$ and $\OPT$ exactly correspond to each other if and only if (1) for each $\vbeta \in \Fm$, the 
  preimage $(\RmY \circ \OPT)^{-1}(\{\vbeta\})$ is invariant under $\PnX$ and (2) $\PmY$ is the identity operator on 
  the range of $\OPT \circ \EnX$.

  \item \label{lemma:prop:corresp:natural_op_discr_corresp:b_hilbert_linear}
  If $\SPCX$ is a Hilbert space and $\OPT$ and $\RmY$ are linear and bounded, the condition on $\PnX$ in 
  \eqref{lemma:prop:corresp:natural_op_discr_corresp:a_general} can be rephrased as the following: 
  (1a) $\PnX$ is equal to the identity operator on $\NULL(\RmY \circ \OPT)^\perp$ and (1b) 
  $\NULL(\RmY \circ \OPT)$ is invariant under $\PnX$.
  
  \todo{Maybe one should say something about approximate correspondence if possible.}
 \end{enumerate}
\end{lemma}
\vspace{1em}


\begin{proof}~
 \begin{enumerate}[(a)]
  \item Right-composing the discretized operator $\DISCOPT = \RmY \circ \OPT \circ \EnX$ with $\RnX$ results in
  %
  \begin{equation*}
   \DISCOPT \circ \RnX = \RmY \circ \OPT \circ \PnX,
  \end{equation*}
  %
  and by left-composing $\DISCOPT$ with $\EmY$, we get
  %
  \begin{equation*}
   \EmY \circ \DISCOPT = \PmY \circ \OPT \circ \EnX.
  \end{equation*}
  %
  Let now $\vbeta \in \Fm$ be arbitrary and $A \DEFEQ  (\RmY \circ \OPT)^{-1}(\{\vbeta\})$ be its preimage.
  To show the ``if'' part, we observe that for each $f \in A$, it is $\PnX(f) \in A$ since $A$ is invariant under 
  $\PnX$. Hence, $\RmY \circ \OPT \big( \PnX(f) \big) = \vbeta$. This shows 
  $\RmY \circ \OPT \circ \PnX = \RmY \circ \OPT$, i.e. the first condition 
  in \Cref{def:discr:corresp:operator_compat}~\eqref{def:discr:corresp:operator_compat:a_exact} is fulfilled.\\
  %
  Obviously, if $\PmY$ is the identity on the range of $\OPT \circ \EnX$, the right hand side of the second identity 
  is $\PmY \circ \OPT \circ \EnX = \OPT \circ \EnX$. This implies the second equation in 
  \Cref{def:discr:corresp:operator_compat}~\eqref{def:discr:corresp:operator_compat:a_exact} and concludes this part of 
  the proof.\\
  %
  For the ``only if'' part, we assume that there is $f \in A$ with $\PnX(f) \not\in A$. By definition, this means 
  $\RmY \circ \OPT \big( \PnX(f) \big) \neq \vbeta$, which violates the condition
  $\vbeta = \RmY \circ \OPT (f) = \RmY \circ \OPT \circ \PnX (f)$. Hence, $A$ must be invariant under $\PnX$.\\
  %
  Apparently, $\PmY \circ \OPT \circ \EnX = \OPT \circ \EnX$ means that for each $g = \OPT \circ \EnX(\valpha)$, 
  it holds $\PmY(g) = g$, i.e. $\PmY$ is the identity on the range of $\OPT \circ \EnX$.

  \item To prove \eqref{lemma:prop:corresp:natural_op_discr_corresp:b_hilbert_linear}, we first observe that 
  $\NULL(\RmY \circ \OPT) = (\RmY \circ \OPT)^{-1}(\{\vzero\})$. Further, since $\SPCX$ is a Hilbert space 
  and $\RmY \circ \OPT$ linear and bounded, each $f \in \SPCX$ can be uniquely decomposed into 
  $f = f_0 + \tilde f$ with  $f_0 \in \NULL(\RmY \circ \OPT)$ and 
  $\tilde f \in \NULL(\RmY \circ \OPT)^\perp$. Hence, for each $\vbeta \in \Fm$,
  %
  \begin{equation*}
   (\RmY \circ \OPT)^{-1}({\vbeta}) = \tilde f + \NULL(\RmY \circ \OPT)
  \end{equation*}
  %
  for a unique $\tilde f \in \NULL(\RmY \circ \OPT)^\perp$. Thus, the conditions on $\PnX$ in 
  \eqref{lemma:prop:corresp:natural_op_discr_corresp:b_hilbert_linear} are equivalent to those in   
  \eqref{lemma:prop:corresp:natural_op_discr_corresp:a_general}.
  
%  \item 
 \end{enumerate}
\end{proof}



\subsection{Compatibility of linear combinations}
\label{subsec:prop:lincomb}

Let $\SPCX$ be a vector space over $\FIELD$ with its usual discretization. The linear combination in vector spaces 
can be formally defined as an operator, and as such it implies a natural discretization. In the following, we 
investigate how it relates to the usual linear combination in $\Fn$ and under which conditions they correspond to 
each other.


\begin{lemma}
 \label{lemma:prop:lincomb:natural_corresp}
 Let $\SPCX$ be a vector space over $\FIELD$ with linear discretization $\DISCRnX$.
 \begin{enumerate}[(a)]
  \item The linear combination in $\Fn$ is the natural discretization of the linear combination in $\SPCX$ if 
  and only if the projection $\QnX = \RnX \circ \EnX$ is the identity.
  
  \item The linear combinations in $\SPCX$ and $\Fn$ exactly correspond to each other.
 \end{enumerate}
\end{lemma}
\vspace{1em}


\begin{proof}~
 \begin{enumerate}[(a)]
  \item The linear combination in $\SPCX$ can be written as an operator 
  %
  \begin{equation*}
   \OPT \colon \FIELD \times \FIELD \times \SPCX \times \SPCX \to \SPCX
   \quad \text{with} \quad
   \OPT(\mu, \lambda, f, g) \DEFEQ  \lambda \cdot f + \mu \cdot g
  \end{equation*}
  %
  with natural discretization $\DISCOPT = \RnX \circ \OPT \circ (\OPID, \OPID, \EnX, \EnX)$.
  Hence, for $\lambda, \mu \in \FIELD$ and $\valpha, \vbeta \in \Fn$, it is
  %
  \begin{align*}
   \DISCOPT(\lambda, \mu, \valpha, \vbeta) 
   &= \RnX \circ \OPT \big( \lambda, \mu, \EnX(\valpha), \EnX(\vbeta) \big)\\
   &= \RnX \big( \lambda \cdot \EnX(\valpha) + \mu \cdot \EnX(\vbeta) \big) \\ 
   &= \RnX \circ \EnX(\lambda \cdot \valpha + \mu \cdot \vbeta).
  \end{align*}
  %
  This expression is equal to $\lambda \cdot \valpha + \mu \cdot \vbeta$ for all $\lambda, \mu \in \FIELD$ and all 
  $\valpha, \vbeta \in \Fn$ if and only if $\RnX \circ \EnX = \OPID$.

  \item The conditions for exact correspondence according to \Cref{def:discr:corresp:operator_compat} can be 
  rephrased as
  %
  \begin{align*}
   \RnX(\lambda \cdot f + \mu \cdot g) &= \lambda \cdot \RnX(f) + \mu \cdot \RnX(g), \\
   \EnX(\lambda \cdot \valpha + \mu \cdot \vbeta) &= \lambda \cdot \EnX(\valpha) + \mu \cdot \EnX(\vbeta),
  \end{align*}
  %
  and are fulfilled due to the linearity of $\RnX$ and $\EnX$.
 \end{enumerate}
\end{proof}

\begin{remark}
 \label{remark:prop:lincomb:natural_linop_space}
 In the vector space $\SPCL \DEFEQ  \BLINOP{\SPCX}{\SPCY}$ with given discretizations in $\SPCX$ and $\SPCY$, the 
 natural restriction and extension operators of the discretization $\DISCR{\SPCL}{m\times n}$ are given by
 %
 \begin{equation*}
  \REST{m\times n}{\SPCL}(\OPT) = \RmY \circ \OPT \circ \EnX
  \quad\text{and}\quad
  \EXT{m\times n}{\SPCL}(\DISCOPT) = \EmY \circ \DISCOPT \circ \RnX,
 \end{equation*}
 %
 see \Cref{def:discr:operator:linop_space:linop_space_discr}. Hence, the condition that the natural discretization of 
 the linear combination in $\SPCL$ is the linear combination in $\Fmxn$ reads as
 %
 \begin{align*}
  \DISCOPT 
  &= \REST{m\times n}{\SPCL}\big( \EXT{m\times n}{\SPCL}(\DISCOPT) \big)
  = \RmY \circ \EXT{m\times n}{\SPCL}(\DISCOPT) \circ \EnX
  = \RmY \circ \EmY \circ \DISCOPT \circ \RnX \circ \EnX \\
  &= \QmY \circ \DISCOPT \circ \QnX.
 \end{align*}
 %
 Thus, if $\QnX = \OPID$ and $\QmY = \OPID$, the operator space discretization $\DISCR{\SPCL}{m\times n}$ 
 automatically fulfills the condition $\COPROJ{m\times n}{\SPCL} = \OPID$ needed for the natural discretization of 
 the linear combination.
\end{remark}



\subsection{Compatibility of norms}
\label{subsec:prop:norm}

We now consider the setting when $\SPCX$ is a normed vector space, including the space of bounded linear operators.


\begin{lemma}
 \label{lemma:prop:norm:natural_corresp}
 Let $\SPCX$ be a vector space over $\FIELD$ with norm $\NORMINX{}$ and linear discretization 
 $\DISCRnX$. Let further $\NORMINFn{}$ be a norm in $\Fn$.
 %
 \begin{enumerate}[(a)]
  \item \label{lemma:prop:norm:natural_corresp:a_natural}
  $\NORMINFn{}$ is the natural discretization of $\NORMINX{}$ if and only if
  %
  \begin{equation*}
   \EnX \colon (\Fn, \NORMINFn{}) \to (\SPCX, \NORMINX{})
  \end{equation*}
  %
  is an isometry.
  
  \item \label{lemma:prop:norm:natural_corresp:b_corresp}
  $\NORMINFn{}$ corresponds to $\NORMINX{}$ if and only if
  %
  \begin{equation*}
   \RnX \colon (\SPCX, \NORMINX{}) \to (\Fn, \NORMINFn{})
   \quad \text{and} \quad
   \EnX \colon (\Fn, \NORMINFn{}) \to (\SPCX, \NORMINX{})
  \end{equation*}
  %
  are isometries.
 \end{enumerate}
\end{lemma}
\vspace{1em}


\begin{proof}
 We write the norm as an operator
 %
 \begin{equation*}
  \OPT \colon \SPCX \to \RR \quad \text{with} \quad \OPT(f) \DEFEQ  \NORMINX{f}.
 \end{equation*}
 %
 Its natural discretization is given by
 %
 \begin{equation*}
  \DISCOPT \colon \Fn \to \RR \quad \text{with} \quad \DISCOPT = \OPID \circ \OPT \circ \EnX,
 \end{equation*}
 %
 \ie, $\DISCOPT(\valpha) = \NORMINX*{\EnX(\valpha)}$. This proves the claim in 
 \eqref{lemma:prop:norm:natural_corresp:a_natural}.\\
 %
 The conditions for correspondence read as
 %
 \begin{equation*}
  \NORMINX{} = \NORMINFn{} \circ \RnX
  \quad \text{and} \quad
  \NORMINFn{} = \NORMINX{} \circ \EnX
 \end{equation*}
 %
 and are equivalent to the isometry conditions in \eqref{lemma:prop:norm:natural_corresp:b_corresp}.
\end{proof}

\begin{remark}
 The proof additionally shows that the natural norm discretization fulfills
 $\DISCOPT(\valpha) \leq \NORM{\EnX}\, \NORMINFn{\valpha}$, i.e. the discretized norm can be bounded from above 
 with the given norm in $\Fn$.
\end{remark}


\paragraph{Operator norms}

In a similar way, we can analyze the relation between norms of continuous and discretized linear operators. 
The norms of operators $\OPT \in \SPCL \DEFEQ  \BLINOP{\SPCX}{\SPCY}$ and 
$\DISCOPT \in \SPCL(\Fn, \Fm) \simeq \Fmxn$ are defined as
%
\begin{equation*}
 \NORMIN{\SPCL}{\OPT} \DEFEQ  \sup_{\NORMINX{f} \leq 1} \NORMINY*{\OPT(f)}
 \quad \text{and} \quad
 \NORMIN{m\times n}{\DISCOPT} \DEFEQ  \sup_{\NORMINFn{\valpha} \leq 1} \NORMINFn*{\DISCOPT(\valpha)}.
\end{equation*}
%
The following Lemma shows how operator and matrix norms relate to each other under discretization.


\begin{lemma}
 \label{lemma:prop:norm:op_norm_est}
 Let $\SPCX$ and $\SPCY$ be normed vector spaces with linear discretizations $\DISCRnX$ and 
 $\DISCRmY$, respectively. Let further $\REST{m\times n}{\SPCL}(\OPT)$ and 
 $\EXT{m\times n}{\SPCL}(\DISCOPT)$ be the natural restriction and extension operators in 
 $\DISCR{\SPCL}{m\times n}$ as given in \Cref{def:discr:operator:linop_space:linop_space_discr}.
 %
 \begin{enumerate}[(a)]
  \item \label{lemma:prop:norm:op_norm_est:a_rest}
  If the operator norms of $\RmY$ and $\EnX$ are bounded by 1, then
  %
  \begin{equation*}
   \NORMIN*{\BLINOP{\SPCL}{\Fmxn}}{\REST{m\times n}{\SPCL}} \leq 1.
  \end{equation*}
  %
  Furthermore, if $\RmY$ and $\EnX$ are isometries and $\RmY$ is surjective, $\EXT{m\times n}{\SPCL}$ is an 
  isometry, \ie, $\NORMIN{m\times n}{}$ is the natural discretization of $\NORMIN{\SPCL}{}$.
  
  \item \label{lemma:prop:norm:op_norm_est:b_ext}
  If the operator norms of $\RnX$ and $\EmY$ are bounded by 1, then
  %
  \begin{equation*}
   \NORMIN*{\BLINOP{\Fmxn}{\SPCL}}{E_{m\times n}^{\SPCL}} \leq 1.
  \end{equation*}
 \end{enumerate}
\end{lemma}
\vspace{1em}


\begin{proof}~
 \begin{enumerate}[(a)]
  \item For $\OPT \in \SPCL$ and $\DISCOPT = \REST{m\times n}{\SPCL}(\OPT)$ we have
  %
  \begin{equation*}
   \NORMINFm*{\DISCOPT(\valpha)} = \NORMINFm*{\RmY \left( \OPT\big( \EnX(\valpha) \big) \right)}
   \leq \NORMINY*{\OPT\big( \EnX(\valpha) \big)}
  \end{equation*}
  %
  since $\NORM{\RmY} \leq 1$. Furthermore, $\EnX$ maps the unit ball in $\Fn$ to a subset of the unit ball in
  $\SPCX$ since $\NORM{\EnX} \leq 1$. Hence,
  %
  \begin{equation*}
   \sup_{\NORMINFn{\valpha} \leq 1} \NORMINY*{\OPT\big( \EnX(\valpha) \big)}
   = \sup_{\substack{f=\EnX(\valpha)\\ \NORMINFn{\valpha} \leq 1}} \NORMINY*{\OPT(f)}
   \leq \sup_{\NORMINX{f} \leq 1} \NORMINY*{\OPT(f)},
  \end{equation*}
  %
  which proves that $\NORM*{\REST{m\times n}{\SPCL}(\OPT)} \leq \NORM{\OPT}$.

  \item Analogously, for $\DISCOPT \in \Fmxn$ and $\OPT = \EXT{m\times n}{\SPCL}(\DISCOPT)$ it is
  %
  \begin{equation*}
   \NORMINY*{\OPT(f)} = \NORMINY*{\EmY \left( \DISCOPT\big( \RnX(f) \big) \right)}
   \leq \NORMINFm{\DISCOPT\big( \RnX(f) \big)}
  \end{equation*}
  %
  since $\NORM{\EmY} \leq 1$. In addition, $\RnX$ maps the unit ball in $\SPCX$ to a subset of the unit 
  ball in $\Fn$ since $\NORM{\RnX} \leq 1$. Hence,
  %
  \begin{equation*}
   \sup_{\NORMINX{f} \leq 1} \NORMINFm{\DISCOPT\big( \RnX(f) \big)}
   = \sup_{\STACK{\valpha=\RnX(f)}{\NORMINX{f} \leq 1}} \NORMINFm{\DISCOPT(\valpha)}
   \leq \sup_{\NORMINFn{\valpha} \leq 1} \NORMINFm{\DISCOPT(\valpha)},
  \end{equation*}
  %
  \ie, $\NORM*{E_{m\times n}^{\SPCL}(\DISCOPT)} \leq \NORM{\DISCOPT}$.\\[1em]
  %
  If $\EmY$ is an isometry, the first inequality becomes an equality, and if $\RnX$ is a surjective isometry, it maps
  the unit ball in $\SPCX$ \emph{onto} the unit ball in $\Fn$. Thus, also the second inequality becomes an 
  equality, showing that $\NORM*{\EXT{m\times n}{\SPCL}(\DISCOPT)} = \NORM{\DISCOPT}$ for all 
  $\DISCOPT \in \Fmxn$ in this case. According to 
  \Cref{lemma:prop:norm:natural_corresp}~\eqref{lemma:prop:norm:natural_corresp:a_natural}, this means that the natural 
  operator norm discretization is the matrix norm in $\Fmxn$.
 \end{enumerate}
\end{proof}


\begin{remark}
 \label{remark:prop:norm:op_norm_corresp}
 An analogous isometry property for $\REST{m\times n}{\SPCL}$ can only hold if $\DIM(\SPCX) \leq n$ 
 since it requires the extension map $\EnX \colon \Fn \to \SPCX$ to be surjective. Hence, exact correspondence 
 of a matrix norm to an operator norm is only possible for certain finite-dimensional spaces $\SPCX$.\\
 %
 In any case, the inequalities ensure that one can get an estimate for the operator norm of $\OPT$ (restricted to the 
 range of $\EnX$) in terms of the discretized (matrix) norm of $\DISCOPT$, which can be very useful in numerical 
 computations.
\end{remark}



\subsection{Compatibility of inner products}
\label{subsec:prop:inner}

Now we consider inner product spaces and analyze their behavior under discretization.


\begin{lemma}
 \label{lemma:prop:inner:natural_corresp}
 Let $\big( \SPCX, \INNERINX{}{} \big)$ be an inner product space with discretization $\DISCRnX$, and 
 let $\INNERIN{n}{}{}$ be the inner product in $\Fn$.
 %
 \begin{enumerate}[(a)]
  \item \label{lemma:prop:inner:natural_corresp:a_natural}
  $\INNERINFn{}{}$ is the natural discretization of the inner product $\INNERINX{}{}$ if and 
  only if $\EnX$ is unitary.
  
  \item \label{lemma:prop:inner:natural_corresp:b_corresp}
  $\INNERINFn{}{}$ exactly corresponds to $\INNERINX{}{}$ if and only if both $\RnX$ and 
  $\EnX$ are unitary.
 \end{enumerate}
\end{lemma}
\vspace{1em}


\begin{proof}~
 \begin{enumerate}[(a)]
  \item We define the inner product as an operator
  %
  \begin{equation*}
   \OPT \colon \SPCX \times \SPCX \to \FIELD
   \quad \text{with} \quad
   \OPT(f, g) \DEFEQ  \INNERINX{f}{g}.
  \end{equation*}
  %
  The natural discretization of this operator is given by $\DISCOPT = \OPID \circ \OPT \circ (\EnX, \EnX)$, \ie,
  %
  \begin{align*}
   \DISCOPT(\valpha, \vbeta) 
   &= \OPT\big( \EnX(\valpha), \EnX(\vbeta) \big) 
   = \INNERINX[\big]{\EnX(\valpha)}{\EnX(\vbeta)} \\
   &= \INNERINFn[\big]{(\EnX)^* \circ \EnX(\valpha)}{\vbeta}.
  \end{align*}
  %
  Apparently, this expression is equal to $\INNERINFn{\valpha}{\vbeta}$ if and only if $\EnX$ is unitary.

  \item The conditions for exact correspondence can be written as
  %
  \begin{equation*}
   \INNERINX{f}{g} = \INNERINFn[\big]{\RnX(f)}{\RnX(g)}
   \quad \text{and} \quad
   \INNERINFn{\valpha}{\vbeta} = \INNERINX[\big]{\EnX(\valpha)}{\EnX(\vbeta)},
  \end{equation*}
  %
  which is equivalent to the conditions in the claim.
 \end{enumerate}
\end{proof}



\subsection{Summary}
\label{subsec:prop:summary}

We summarize the properties of linear discretizations along with the corresponding conditions. Recall the definitions 
of 
the (projection) operators
%
\begin{equation*}
 \PnX = \EnX \circ \RnX \colon \SPCX \to \SPCX
 \quad \text{and} \quad
 \QnX = \RnX \circ \EnX \colon \Fn \to \Fn,
\end{equation*}
%
see \Cref{def:discr:space:space_discr}.%
%
\renewcommand{\arraystretch}{1.1}%
\begin{longtable}{>{\raggedright}p{0.30\linewidth}<{\raggedright} %
                  >{\raggedright}p{0.45\linewidth}<{\raggedright} %
                  p{0.15\linewidth}}
  \multicolumn{3}{c}{\textbf{Natural discretization = known operation}} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  \textbf{Object} & \textbf{Conditions} & \textbf{Shown in} \endfirsthead 
  \textbf{Object} & \textbf{Conditions} & \textbf{Shown in} \endhead 
  %
  %
  \noalign{\smallskip} \hline\hline \noalign{\smallskip}
  %
  %
  Fr\'{e}chet derivative &
  $\EnX, \RmY$ bounded &
  \Cref{lemma:discr:operator:op_deriv:natural_is_deriv} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Adjoint &
  $\EnX = \big( \RnX \big)^*$ and $\EmY = \big( \RmY \big)^*$ &
  \Cref{lemma:discr:operator:op_adj:natural_is_adj} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Operator composition of $\OPT \colon \SPCX \to \SPCY$ and $\OPU \colon \SPCY \to \SPCZ$ &
  Either $\PmY$ identity on $\RANGE(\OPT \circ \EnX)$ or single-element preimages of 
  $\REST{k}{\SPCZ} \circ \OPU$ invariant under $\PmY$ &
  \Cref{lemma:discr:operator:op_comp:natural_is_comp} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Linear combination &
  $\QnX$ identity &
  \Cref{lemma:prop:lincomb:natural_corresp} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Linear combination in $\BLINOP{\SPCX}{\SPCY}$ under natural discretization &
  $\QnX$ and $\QmY$ identity operators &
  \Cref{remark:prop:lincomb:natural_linop_space} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Norm &
  $\EnX$ isometry &
  \Cref{lemma:prop:norm:natural_corresp} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Operator norm under natural discretization &
  $\RmY, \EnX$ isometries and $\RmY$ surjective &
  \Cref{lemma:prop:norm:op_norm_est} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Inner product &
  $\EnX$ unitary &
  \Cref{lemma:prop:inner:natural_corresp} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}%
 \caption{Summary of the results on natural discretization as given in \Cref{sec:prop}}%
 \label{tab:prop:summary:natural_summary}%
\end{longtable}%
\renewcommand{\arraystretch}{1.0}%
%
\noindent
\Cref{tab:prop:summary:natural_summary} shows the results regarding the equality of natural discretizations and known 
operations in the discretized spaces, and \Cref{tab:prop:summary:exaxt_corresp_summary} is an overview of the results 
on exact correspondence.
\newpage
%
\renewcommand{\arraystretch}{1.1}
\begin{longtable}{>{\raggedright}p{0.30\linewidth}<{\raggedright} %
                  >{\raggedright}p{0.45\linewidth}<{\raggedright} %
                  p{0.15\linewidth}}
  \multicolumn{3}{c}{\textbf{Exact correspondence}} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  \textbf{Object} & \textbf{Conditions} & \textbf{Shown in} \endfirsthead
  \textbf{Object} & \textbf{Conditions} & \textbf{Shown in} \endhead
  %
  %
  \noalign{\smallskip} \hline\hline \noalign{\smallskip} 
  %
  %
  $\DISCOPT = \RmY \circ \OPT \circ \EnX$ (natural operator discretization) &
  (1) Single-element preimages of $\RmY \circ \OPT$ are invariant under $\PnX$ and & 
  \Cref{lemma:prop:corresp:natural_op_discr_corresp} \\
  %
  &
  (2) $\PmY$ is the identity on $\RANGE(\OPT \circ \EnX)$ &
  \\
  \noalign{\smallskip}
  Special case: $\SPCY$ Hilbert space and $\OPT$ linear and &
  (1a) $\PnX$ is identity on $\NULL(\RmY \circ \OPT)^\perp$ and &
  \\
  bounded &
  (1b) $\NULL(\RmY \circ \OPT)$ invariant under $\PnX$ and (2) as above &
  \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Linear combination &
  None beyond linearity &
  \Cref{lemma:prop:lincomb:natural_corresp} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Norm &
  $\RnX$ and $\EnX$ isometries &
  \Cref{lemma:prop:norm:natural_corresp} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Operator norm under natural discretization &
  $\RnX, \EnX, \RmY, \EmY$ isometries and $\EnX, \RmY$ surjective &
  \Cref{lemma:prop:norm:op_norm_est} \\
  &
  (implies $\DIM(\SPCX) \leq n$) &
  \Cref{remark:prop:norm:op_norm_corresp} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  Inner product &
  $\RnX, \EnX$ unitary &
  \Cref{lemma:prop:inner:natural_corresp} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
 \caption{Summary of the conditions for exact correspondence in different situations as analyzed in \Cref{sec:prop}}
 \label{tab:prop:summary:exaxt_corresp_summary}
\end{longtable}
\renewcommand{\arraystretch}{1.0}





\section{Specific discretizations}
\label{sec:specif}

We will now consider various specific discretizations and investigate their properties in the light of the 
results in \Cref{sec:prop}.



\subsection{Functionals and dictionaries}
\label{subsec:specif:funct}

Let $\SPCX$ be a vector space over $\FIELD$ and $\Lambda = \{\lambda_1, \dots, \lambda_n\}$ a set of linear mappings
$\lambda_i \colon \SPCX \to \FIELD$. With those we define the restriction mapping
%
\begin{equation*}
 \RnX \colon \SPCX \to \Fn \quad \text{as} \quad \RnX(f) \DEFEQ  \big( \lambda_i(f) \big)_{i=1}^n.
\end{equation*}
%
Let further $\Phi=\{\phi_1, \dots, \phi_n\} \subset \SPCX$ be a set of elements (a \emph{dictionary}) in $\SPCX$. We 
define the extension operator
%
\begin{equation*}
 \EnX \colon \Fn \to \SPCX \quad \text{as} \quad \EnX(\valpha) \DEFEQ  \sum_{i=1}^n \overline{\alpha_i}\, \phi_i.
\end{equation*}
%
The corresponding projection operators are then given by
%
\begin{equation*}
 \PnX(f) \DEFEQ  \sum_{i=1}^n \overline{\lambda_i(f)}\, \phi_i
 \quad \text{and} \quad
 \left[ \QnX \right]_{i,j} \DEFEQ  \overline{\lambda_i(\phi_j)},\quad i,j=1,\dots,n.
\end{equation*}
%
For these specific operators, we can rephrase some of the properties arising as conditions in \Cref{sec:discr,sec:prop} 
in terms of $\Lambda$ and $\Phi$. We start with the general vector space case and proceed with normed spaces and 
Hilbert spaces.


\begin{lemma}~
 \label{lemma:specif:funct:op_prop_vecspace}
 \begin{enumerate}[(a)]
  \item \label{lemma:specif:funct:op_prop_vecspace:Q_identity}
  $\QnX = \vI$ if and only if $\lambda_i(\phi_j) = \delta_{i,j},\ i,j=1,\dots,n$.
  
  \item \label{lemma:specif:funct:op_prop_vecspace:R_surjective}
  $\RnX$ is surjective if and only if $\Lambda$ is linearly independent.
  
  \item \label{lemma:specif:funct:op_prop_vecspace:E_surjective}
  $\EnX$ is surjective if and only if $\SPCX = \SPAN(\Phi)$.
 \end{enumerate}
\end{lemma}
\vspace{1em}


\begin{proof}
 Obvious.
\end{proof}


\begin{lemma}
 \label{lemma:specif:funct:op_prop_normedspace}
 Let $\SPCX$ and $\Fn$ be normed spaces and let the norm $\NORMINFn{}$ fulfill the norm equivalence
 %
 \begin{equation*}
  c_1 \NORMINFn{} \leq \NORMIN{\mathrm{M}}{} \leq C_1 \NORMINFn{}
 \end{equation*}
 %
 with constants $0 < c_1 \leq C_1$, where $\NORMIN{\mathrm{M}}{}$ is the ``Manhattan''- or 1-norm.

 \begin{enumerate}[(a)]
  \item \label{lemma:specif:funct:op_prop_normedspace:R_bounded}
  $\NORMINFn*{\RnX(f)} \leq c_1^{-1} \sum_{i=1}^n \ABS{\lambda_i(f)}$, \ie, $\RnX$ is bounded if and only if all 
  mappings $\lambda_i$ are bounded (\emph{functionals}).
  %
  \item \label{lemma:specif:funct:op_prop_normedspace:E_bounded}
  $\NORMINX*{\EnX(\valpha)} \leq C_1\, \max_i \NORMINX{\phi_i}\, \NORMINFn{\valpha}$, hence $\EnX$ is bounded.
 \end{enumerate}
\end{lemma}
\vspace{1em}


\begin{proof}~
 \begin{enumerate}[(a)]
  \item It is
  %
  \begin{align*}
   \NORMINFn{\RnX(f)} 
   &= \NORMINFn{\big( \lambda_1(f), \dots, \lambda_n(f) \big)} \\
   &\leq c_1^{-1} \sum_{i=1}^n \ABS{\lambda_i(f)} \leq n\,c_1^{-1}\, \max_i \ABS{\lambda_i(f)}
  \end{align*}
  %
  according to the norm equivalence. This proves the claim.
  
  \item For the operator $\EnX$, we use the triangle inequality and the norm equivalence to get
  %
  \begin{align*}
   \NORMINX{\EnX(\valpha)} 
   &= \NORMINX[\bigg]{\sum_{i=1}^n \alpha_i\, \phi_i} \leq \sum_{i=1}^n \ABS{\alpha_i}\, \NORMINX{\phi_i} \\
   &\leq \max_i \NORMINX{\phi_i}\, \NORMIN{\mathrm{M}}{\valpha} \leq C_1\, \max_i \NORMINX{\phi_i}\, 
   \NORMINFn{\valpha}.
  \end{align*}
 \end{enumerate}
\end{proof}


\begin{lemma}
 \label{lemma:specif:funct:op_prop_hilbert}
 Let $\SPCX$ and $\Fn$ be Hilbert spaces. Let further $\vA \in \Fnxn$ be the Hermitian positive 
 definite matrix defining the inner product in $\Fn$, \ie,
 %
 \begin{equation*}
  \INNERINFn{\valpha}{\vbeta} \EQDEF \HERM{\valpha} \vA \vbeta
 \end{equation*}
 %
 with $\HERM{\valpha} \DEFEQ  \TRANSP{\overline{\valpha}}$. The norms in $\SPCX$ and $\Fn$ be defined via 
 the respective inner products. Let further $\Theta \subset \SPCX$ be the Riesz representants of the functionals 
 $\lambda_i$ in the sense that $\lambda_i = \INNERINX{\theta_i}{},\ i=1,\dots,n$.
 %
 \begin{enumerate}[(a)]
  \item \label{lemma:specif:funct:op_prop_hilbert:Q_identity}
  $\QnX$ is the identity if and only if the sets $\Theta$ and $\Phi$ are bi-orthonormal, \ie, 
  $\INNERINX{\theta_i}{\phi_j} = \delta_{i,j}$.
 
  \item \label{lemma:specif:funct:op_prop_hilbert:R_adjoint_repr}
  The adjoint operators $(\RnX)^*$ and $(\EnX)^*$ have the representations
  %
  \begin{equation*}
   (\RnX)^*(\valpha) = \sum_{i=1}^n (\HERM{\valpha}\vA)_i\, \theta_i
   \quad \text{and} \quad
   (\EnX)^(f) = \vA^{-1} \bar f
  \end{equation*}
  %
  with $\bar f = \big( \INNERINX{\phi_i}{f} \big)_{i=1,\dots,n}$.
  
  \item \label{lemma:specif:funct:op_prop_hilbert:R_E_adjoint_relation}
  It is $(\RnX)^* = \EnX$ if and only if $\vA$ is the change-of-basis matrix from $\Theta$ to $\Phi$, \ie,
  %
  \begin{equation*}
   \phi_i = \sum_{j=1}^n A_{i,j}\, \theta_j.
  \end{equation*}
  %
  This implies in particular that the linear spans of $\Theta$ and $\Phi$ are identical.
 
  \item  \label{lemma:specif:funct:op_prop_hilbert:E_isometry}
  $\EnX$ is an isometry if and only if $\Phi$ is linearly independent and $\vA$ is the Gramian matrix $\vG_\Phi$ 
  defined by $(G_\Phi)_{i,j} \DEFEQ  \INNERINX{\phi_i}{\phi_j},\ i,j=1,\dots,n$.
  
  \item \label{lemma:specif:funct:op_prop_hilbert:R_isometry}
  $\RnX$ is an isometry if and only if $\DIM(\SPCX) = n$, $\Theta$ is linearly independent and $\vA$ is the 
  inverse of the Gramian matrix $\vG_\Theta$.
 \end{enumerate}
\end{lemma}
\vspace{1em}


\begin{proof}~
 \begin{enumerate}[(a)]
  \item This is an immediate consequence of \Cref{lemma:specif:funct:op_prop_vecspace}.
 
  \item To find a representation for the $(\RnX)^*$, we calculate
  %
  \begin{align*}
   \INNERINFn[\big]{\RnX(f)}{\valpha} 
   &= \HERM{\RnX(f)} \vA \valpha = \sum_{i,j=1}^n \INNERINX{f}{\theta_i}\, A_{i,j}\, \alpha_j
   = \INNERINX[\bigg]{f}{\sum_{i,j=1}^n \overline{A_{i,j}}\, \overline{\alpha_j}\, \theta_i} \\
   &= \INNERINX[\bigg]{f}{\sum_{i,j=1}^n \overline{\alpha_j}\, A_{j,i}\, \theta_i} 
   = \INNERINX[\bigg]{f}{\sum_{i=1}^n (\HERM{\valpha} \vA)_i\, \theta_i},
  \end{align*}
  %
  from which the first claim follows. Likewise, it is
  %
  \begin{equation*}
   \INNERINX[\big]{\EnX(\valpha)}{f}
   = \sum_{i=1}^n \overline{\alpha_i}\, \INNERINX{\phi_i}{f}
   = \HERM{\valpha} \bar f
   = \INNERINFn[\big]{\valpha}{\vA^{-1} \bar f},
  \end{equation*}
  %
  and the adjoint of $\EnX$ can be read off this identity.

  \item For each $\valpha \in \Fn$, we require $\EnX(\valpha) = (\RnX)^*(\valpha)$, \ie,
  %
  \begin{equation}
   \label{eq:funct:op_prop_hilbert:adjoint_relation:cond}
   \tag{{$\ast$}}
   \sum_{i=1}^n \overline{\alpha_i}\, \phi_i = \sum_{i,j=1}^n \overline{\alpha_j} A_{j,i}\, \theta_i.
  \end{equation}
  %
  If $\phi_i = \sum_{j=1}^n A_{i,j}\, \theta_j$, we see immediately that
  %
  \begin{equation*}
   \sum_{i=1}^n \overline{\alpha_i}\, \phi_i = \sum_{i,j=1}^n \overline{\alpha_i}\, A_{i,j}\, \theta_j,
  \end{equation*}
  %
  thus the operators are equal as required. To prove the converse, we now assume $\EnX = (\RnX)^*$ and show that 
  $\Phi$ and $\Theta$ fulfill the claimed relation. First, we apply the functionals 
  $\mu_k \DEFEQ  \INNERINX{\phi_k}{},\ k=1,\dots,n$, to both sides of 
  \eqref{eq:funct:op_prop_hilbert:adjoint_relation:cond}, yielding
  %
  \begin{equation*}
   \sum_{i=1}^n \alpha_i \INNERINX{\phi_k}{\phi_i} = \sum_{i,j=1}^n \alpha_i\, A_{j,i}\, \INNERINX{\phi_k}{\theta_j},
  \end{equation*}
  %
  or equivalently $\vG_{\Phi} = \vG_{\Phi,\Theta} \vA$ with the (Gramian) matrices
  %
  \begin{equation*}
   (\vG_{\Phi})_{i,j} \DEFEQ  \INNERINX{\phi_i}{\phi_j}
   \quad \text{and} \quad
   (\vG_{\Phi, \Theta})_{i,j} \DEFEQ  \INNERINX{\phi_i}{\theta_j}.
  \end{equation*}
  %
  Likewise, by applying $\nu_k \DEFEQ  \INNERINX{\theta_k}{}$ to both sides of 
  \eqref{eq:funct:op_prop_hilbert:adjoint_relation:cond}, we get
  %
  \begin{equation*}
   \sum_{i=1}^n \alpha_i \INNERINX{\theta_k}{\phi_i} = \sum_{i,j=1}^n \alpha_i\, A_{j,i}\, 
   \INNERINX{\theta_k}{\theta_j},
  \end{equation*}
  %
  \ie, $\vG_{\Theta,\Phi} = \vG_\Theta \vA$ with $\vG_{\Theta,\Phi} = \HERM{\vG_{\Phi,\Theta}}$. Combining both matrix 
  equations results in
  %
  \begin{equation*}
   \vG_{\Phi} = \vG_{\Phi,\Theta} \vA = \HERM{\vA} \HERM{\vG_\Theta} \vA = \vA \vG_\Theta \vA
  \end{equation*}
  %
  since $\vA$ and $\vG_\Theta$ are Hermitian by definition. This transformation equality between the Gramians of the 
  systems $\Phi$ and $\Theta$ implies the claimed relation.
  
  \item It is
  %
  \begin{equation*}
   \NORMINX*{\EnX(\valpha)}^2 = \NORMINX[\Big]{\sum_{i=1}^n \alpha_i\, \phi_i}^2 = 
   \sum_{i,j=1}^n \alpha_i\, \overline{\alpha_j}\, \INNERINX{\phi_i}{\phi_j} = \HERM{\valpha} \vG_\Phi \valpha.
  \end{equation*}
  %
  The Gramian matrix $\vG_\Phi$ is nonsingular and thus defines an inner product if and only if $\Phi$ is linearly 
  independent. Since bilinear forms are uniquely determined by their diagonals, this proves 
  \eqref{lemma:specif:funct:op_prop_hilbert:E_isometry}.
  
  \item As a linear operator with finite-dimensional range, $\RnX$ is compact and thus has a singular value 
  decomposition
  %
  \begin{equation*}
   \RnX(f) = \sum_{k=1}^n \sigma_k\, \INNERINX{f}{v_k}\, u_k
  \end{equation*}
  %
  with singular system $(v_k, u_k; \sigma_k)_{k=1, \dots, \DIM(\SPCX)}$, where $\sigma_k = 0$ for $k > n$. Hence, it 
  is
  %
  \begin{equation*}
   \NORMINFn[\big]{\RnX(f)}^2 = \sum_{k=1}^n \sigma_k^2\, \ABS[\big]{\INNERINX{f}{v_k}}^2 
   = \sum_{k=1}^{\DIM(\SPCX)} \ABS[\big]{\INNERINX{f}{v_k}}^2 = \NORMINX{f}^2
  \end{equation*}
  %
  for all $f\in\SPCX$ if and only if $\DIM(\SPCX) = n$ and $\sigma_k = 1$ for all $k$. By applying the SVD
  representation of $\RnX$ to $\theta_j$, we have
  %
  \begin{equation*}
   \big[ \RnX(\theta_j) \big]_i = \INNERINX{\theta_i}{\theta_j} = \sum_{k=1}^n \INNERINX{\theta_j}{v_k}\, 
   u_{i,k},
  \end{equation*}
  %
  which reads as $\vG_\Theta = \vU \HERM{\vG_{\Theta,V}}$ with 
  $(G_{\Theta,V})_{i,j} \DEFEQ  \INNERINX{\theta_i}{v_j}$. Likewise, applying $\RnX$ to $v_j$ yields
  %
  \begin{equation*}
   \big[ \RnX(v_j) \big]_i = \INNERINX{\theta_i}{v_j} = u_{i,j},
  \end{equation*}
  %
  \ie, $\vU = \vG_{\Theta,V}$. On the other hand, the unit norm property of the vectors $u_k$ can be written in matrix 
  form as $\vU \vA \HERM{\vU} = \HERM{\vU} \vA \vU = \vI$. Combining these properties results in
  %
  \begin{equation*}
   \vG_\Theta \vA \vG_\Theta = \vG_{\Theta,V} \HERM{\vG_{\Theta,V}} \vA \vG_{\Theta,V} \HERM{\vG_{\Theta,V}}
   = \vG_{\Theta,V} \HERM{\vG_{\Theta,V}} = \vG_\Theta,
  \end{equation*}
  %
  and thus $\vA = \vG_\Theta^{-1}$.
 \end{enumerate}
\end{proof}


\begin{corollary}
 \label{coroll:specif:funct:op_prop_hilbert_R_E_adjoint_relation}
 Under the conditions of \Cref{lemma:specif:funct:op_prop_hilbert}, $\EnX$ is equal to $(\RnX)^*$ and 
 an isometry -- and thereby also $\RnX$ -- if and only if $\vA = \vG_\Phi$ with bi-orthonormal dictionaries $\Phi$ and 
 $\Theta$ which span the same space.
\end{corollary}
\vspace{1em}


\begin{proof}
 For the ``only if'' part, we apply \Cref{lemma:specif:funct:op_prop_hilbert}
 \eqref{lemma:specif:funct:op_prop_hilbert:R_E_adjoint_relation}--\eqref{lemma:specif:funct:op_prop_hilbert:R_isometry},
 to see that $\vA = \vG_\Phi$, \ie,
 %
 \begin{equation*}
  \phi_i = \sum_{i=1}^n \INNERINX{\phi_i}{\phi_j}\, \theta_j.
 \end{equation*}
 %
 On the other hand, $\vG_\Phi \vG_\Theta = \vI$, hence by applying $\INNERINX{}{\theta_k}$ to the identity 
 for $\phi_i$ we get
 %
 \begin{equation*}
  \INNERINX{\phi_i}{\theta_k} 
  = \sum_{i=1}^n \INNERINX{\phi_i}{\phi_j}\, \INNERINX{\theta_j}{\theta_k} = \delta_{i,k},
 \end{equation*}
 %
 which shows that $\Phi$ and $\Theta$ are bi-orthonormal.\\
 %
 Conversely, for the ``if'' part, we assume that $\Theta$ and $\Phi$ are bi-orthonormal and span the same space. Then, 
 we can write
 %
 \begin{equation*}
  \phi_i = \sum_{j=1}^n \alpha_{i,j}\, \theta_j
 \end{equation*}
 %
 with coefficients $\alpha_{i,j} \in \FIELD$. Applying the functional $\INNERINX{}{\theta_k}$ yields
 %
 \begin{equation*}
  \delta_{i,k} = \INNERINX{\phi_i}{\theta_k} = \sum_{j=1}^n \alpha_{i,j}\, \INNERINX{\theta_j}{\theta_k},
 \end{equation*}
 %
 which shows that the $\vG_\Theta^{-1} = \vG_\Phi$ is the change-of-basis matrix from $\Theta$ to $\Phi$. Thus, the
 proof is complete.
\end{proof}


Now we investigate the conditions for the compatibility of operator discretizations. Let $\SPCX, \SPCY$ be Hilbert 
spaces with discretizations $\DISCRnX$ and $\DISCRmY$, respectively. The inner products in 
$\Fn$ and $\Fm$ be represented by Hermitian positive definite matrices $\vA \in \Fnxn$ and $\vB 
\in \Fmxm$, respectively. 
Let further the operators $\RnX$ and $\EnX$ be defined as above, and let
%
\begin{equation*}
 \RmY(g) \DEFEQ  \big( \INNERINY{\xi_j}{g} \big)_{j=1}^m
 \quad \text{and} \quad
 \EmY(\vbeta) \DEFEQ  \sum_{j=1}^m \overline{\beta_j}\, \psi_j
\end{equation*}
%
with linearly independent systems $\Xi$ and $\Psi$.

\begin{lemma}
 \label{lemma:specif:funct:op_prop_hilbert_mapping}
 Let $0 \neq \OPT\colon \SPCX \to \SPCY$ be a bounded linear operator. 
 
 \begin{enumerate}[(a)]
  \item \label{lemma:specif:funct:op_prop_hilbert_mapping:PmY}
  Let $\SPCY_n \DEFEQ  \RANGE(\OPT \circ \EnX)$ and $m_0 \DEFEQ  \DIM(\SPCY_n)$. $\PmY$ is the identity on 
  $\SPCY_n$ if and only if (after possibly reordering $\Xi$ and $\Psi$,) it holds
  %
  \begin{enumerate}[({a}1)]
   \item \label{lemma:specif:funct:op_prop_hilbert_mapping:PmY:1_range}
   $\SPCY_n = \SPAN(\Xi_{m_0}) = \SPAN(\Psi_{m_0})$ and
   \item \label{lemma:specif:funct:op_prop_hilbert_mapping:PmY:2_biorth}
   $\Xi_{m_0}$ and $\Psi_{m_0}$ are bi-orthonormal
  \end{enumerate}
  %
  where $\Xi_{m_0} \DEFEQ  \{ \xi_j\, |\, j\leq m_0 \}$ and $\Psi_{m_0}$ analogously. This implies the block 
  structures
  %
  \renewcommand{\arraystretch}{1.1}
  \begin{equation*}
   \vG_{\Xi, \Psi} =
   %
   \left(
   \begin{array}{c|c}
    \vI_{m_0} & \vzero \\[2pt]
    \hline
    \vzero & \boldsymbol{\ast}
   \end{array}
   \right),
   %
   \quad
   %
   \vG_\Xi =
   %
   \left(
   \begin{array}{c|c}
    \vG_{\Xi_{m_0}} & \vzero \\[2pt]
    \hline
    \vzero & \boldsymbol{\ast}
   \end{array}
   \right),
   %
   \quad
   %
   \vG_\Psi =
   %
   \left(
   \begin{array}{c|c}
    \vG_{\Psi_{m_0}} & \vzero \\[2pt]
    \hline
    \vzero & \boldsymbol{\ast}
   \end{array}
   \right)
  \end{equation*}
  \renewcommand{\arraystretch}{1.0}
  %
  for the Gramian matrices, where additionally $\vG_{\Xi_{m_0}} = \vG_{\Psi_{m_0}}^{-1}$. 

  \item \label{lemma:specif:funct:op_prop_hilbert_mapping:PnX}
  Let $\SPCX_m \DEFEQ  \NULL(\RmY \circ \OPT)^\perp$ and $n_0 \DEFEQ  \DIM(\SPCX_m)$. $\PnX$ is the identity on   
  $\SPCX_m$ if and only if (after possibly reordering $\Theta$ and $\Phi$,)
  \eqref{lemma:specif:funct:op_prop_hilbert_mapping:PmY:1_range}--%
  \eqref{lemma:specif:funct:op_prop_hilbert_mapping:PmY:2_biorth}
  hold for $(\SPCX_m, n_0, \Theta, \Phi)$ instead of $(\SPCY_n, m_0, \Xi, \Psi)$.
 \end{enumerate}

\end{lemma}
\vspace{1em}


\begin{proof}~
 \begin{enumerate}[(a)]
  \item Apparently, it is $\SPCY_n = \RANGE(\OPT \circ \EnX) = \SPAN\big( \OPT(\Phi) \big)$, and $\PmY$ being the 
  identity on $\SPCY_n$ means that
  %
  \begin{equation*}
   \OPP \DEFEQ \FUNCRESTR{\PmY}{\SPCY_n} \colon \SPCY_n \to \SPCY_n
  \end{equation*}
  %
  is the identity operator. To prove the ``if'' part, we observe that for $k\leq m_0$, it is
  %
  \begin{equation*}
   \OPP(\psi_k) = \sum_{j=1}^m \INNERINY{\psi_k}{\xi_j}\, \psi_j = \psi_k
  \end{equation*}
  %
  due to the conditions in 
  \eqref{lemma:specif:funct:op_prop_hilbert_mapping:PmY:1_range}--%
  \eqref{lemma:specif:funct:op_prop_hilbert_mapping:PmY:2_biorth}.
  Hence, $\OPP$ is the identity operator since $\SPAN(\Psi_{m_0}) = \SPCY_n$. \\
  %
  For the ``only if'' part, we write the identity $\OPP = \OPID$ as
  %
  \begin{equation}
   \label{lemma:specif:funct:op_prop_hilbert_mapping:PmY:proof_ident}
   \tag{{$\ast$}}
   \OPT(\phi_i) 
   = \sum_{j=1}^m \INNERINY[\big]{\OPT(\phi_i)}{\xi_j}\, \psi_j, \quad i=1,\dots,n,
  \end{equation}
  %
  and infer that
  %
  \begin{equation*}
   \SPAN\SET{ \xi_j \GIVEN j\leq m_0 } = \SPAN\SET{ \psi_j \GIVEN j\leq m_0 } = \SPCY_n.
  \end{equation*}
  %
  This implies that $\SET{ \xi_j \GIVEN j > m_0 }$ and $\SET{ \psi_j \GIVEN j > m_0 }$ are perpendicular to the sets 
  above, \ie,
  %
  \begin{equation*}
   \INNERINY{\xi_j}{\xi_k} = \INNERINY{\psi_j}{\psi_k} = \INNERINY{\xi_j}{\psi_k} = 0
  \end{equation*}
  %
  for $k \leq m_0 < j$ or $j \leq m_0 < k$. On the other hand, by applying $\INNERINY{}{\xi_k}$ to 
  \eqref{lemma:specif:funct:op_prop_hilbert_mapping:PmY:proof_ident}, it follows for $k \leq m_0$ and $i=1,\dots,n$ 
  that
  %
  \begin{equation*}
   \INNERINY{\OPT(\phi_i)}{\xi_k}
   = \sum_{j=1}^m \INNERINY[\big]{\OPT(\phi_i)}{\xi_j}\, \INNERINY{\psi_j}{\xi_k}
   = \INNERINY[\bigg]{\OPT(\phi_i)}{\underbrace{\sum_{j=1}^{m_0} \INNERINY{\xi_k}{\psi_j}\, \xi_j}_{\in \SPCY_n}},
  \end{equation*}
  %
  and thus $\xi_k = \sum_{j=1}^{m_0} \, \xi_j$. The linear independence of $\Xi$ 
  immediately yields $\INNERINY{\xi_k}{\psi_j} = \delta_{k,j}$ for $k,j \leq m_0$. If we now apply
  $\INNERINY{}{\psi_k}$ to \eqref{lemma:specif:funct:op_prop_hilbert_mapping:PmY:proof_ident}, it follows analogously 
  that
  %
  \begin{equation*}
   \psi_k = \sum_{j=0}^{m_0} \INNERINY{\psi_k}{\psi_j}\, \xi_j,
  \end{equation*}
  %
  which concludes the proof.
  
  \item By writing $\SPCX_m = \SPAN\big( \OPT^*(\Xi) \big)$, we can use the same arguments as above to prove the claim.
 \end{enumerate}
\end{proof}


\begin{remark}
 The proof shows that the invariance of $\NULL(\RmY \circ \OPT)$ under $\PnX$ follows from the other conditions.
\end{remark}

We conclude this part with a table to summarize the conditions on the extension and restriction operators, expressed in 
terms of the element collections or functionals.
%
\renewcommand{\arraystretch}{1.1}%
\begin{longtable}{>{\raggedright}p{0.28\linewidth}<{\raggedright} %
                  >{\raggedright}p{0.44\linewidth}<{\raggedright} %
                  p{0.17\linewidth}}
  \textbf{Operator condition} & \textbf{Specific condition} & \textbf{Shown in} \endhead
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip} 
  %
  %
  $\QnX$ identity & 
  $\lambda_i(\phi_j) = \delta_{i,j}$ & 
  \Cref{lemma:specif:funct:op_prop_vecspace}~\eqref{lemma:specif:funct:op_prop_hilbert:Q_identity} \\[0.5em]
  %
  (Hilbert space) &
  $\Theta$, $\Phi$ bi-orthonormal &
  \Cref{lemma:specif:funct:op_prop_hilbert}~\eqref{lemma:specif:funct:op_prop_hilbert:Q_identity}\\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  $\RnX$ surjective &
  $\Lambda$ linearly independent &
  \Cref{lemma:specif:funct:op_prop_vecspace}~\eqref{lemma:specif:funct:op_prop_vecspace:R_surjective} \\[0.5em]
  %
  (Hilbert space) &
  $\Theta$ linearly independent &
  \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  $\EnX$ surjective &
  $\SPCX = \SPAN(\Phi)$ &
  \Cref{lemma:specif:funct:op_prop_vecspace}~\eqref{lemma:specif:funct:op_prop_vecspace:E_surjective} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  $\EnX$ bounded &
  None beyond $\Phi \subset \SPCX$ &
  \Cref{lemma:specif:funct:op_prop_normedspace}~\eqref{lemma:specif:funct:op_prop_normedspace:E_bounded} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  $\RnX$ bounded &
  $\lambda_i$ bounded (functionals) &
  \Cref{lemma:specif:funct:op_prop_normedspace}~\eqref{lemma:specif:funct:op_prop_normedspace:R_bounded} \\[0.5em]
  %
  (Hilbert Space) &
  None beyond $\Theta \subset \SPCX$ &
  \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  $(\RnX)^* = \EnX$ &
  $\vA$ change-of-basis matrix from $\Theta$ to $\Phi$, equivalently: &
  \Cref{lemma:specif:funct:op_prop_hilbert}~\eqref{lemma:specif:funct:op_prop_hilbert:R_E_adjoint_relation} \\[0.5em]
  %
  &
  $\Theta$, $\Phi$ bi-orthonormal with identical spans and $\vA = \vG_\Phi$ &
  \Cref{coroll:specif:funct:op_prop_hilbert_R_E_adjoint_relation} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  $\EnX$ isometry &
  $\Phi$ linearly independent and $\vA = \vG_\Phi$  &
  \Cref{lemma:specif:funct:op_prop_hilbert}~\eqref{lemma:specif:funct:op_prop_hilbert:E_isometry} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  $\RnX$ isometry &
  $\DIM(\SPCX) = n$,  $\Theta$ linearly independent and $\vA = \vG_\Theta^{-1}$  &
  \Cref{lemma:specif:funct:op_prop_hilbert}~\eqref{lemma:specif:funct:op_prop_hilbert:R_isometry} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  $\PmY$ identity on $\SPCY_n$ ($\SPCY_n = \RANGE(\OPT \circ \EnX)$) &
  (1) $\SPCY_n = \SPAN(\Xi_{m_0}) = \SPAN(\Psi_{m_0})$
  (2) $\Xi_{m_0}$ and $\Psi_{m_0}$ bi-orthonormal
  $m_0 = \RANK(\OPT) = \DIM(\SPCY_n)$ &
  \Cref{lemma:specif:funct:op_prop_hilbert_mapping}~\eqref{lemma:specif:funct:op_prop_hilbert_mapping:PmY} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}
  %
  %
  $\PnX$ identity on $\SPCX_m$ ($\SPCX_m = \NULL(\RmY \circ \OPT)^\perp$) &
  (1) $\SPCX_m = \SPAN(\Theta_{n_0}) = \SPAN(\Phi_{n_0})$
  (2) $\Theta_{n_0}$ and $\Phi_{n_0}$ bi-orthonormal
  $n_0 = \DIM(\SPCX_m)$  &
  \Cref{lemma:specif:funct:op_prop_hilbert_mapping}~\eqref{lemma:specif:funct:op_prop_hilbert_mapping:PnX} \\
  %
  %
  \noalign{\smallskip} \hline \noalign{\smallskip}%
 \caption{Summary of the results operator properties in \Cref{subsec:specif:funct}}%
 \label{tab:prop:summary:natural_summary}%
\end{longtable}%
\renewcommand{\arraystretch}{1.0}%





\subsection{Interpolation dictionaries}
\label{subsec:specif:interp}

We now consider the special cases where the dictionary $\Phi$ of the extension operator $\EnX$ corresponds to 
interpolation of a certain order. We derive corresponding bi-orthonormal dictionaries $\Theta$ and give approximation 
formulas for the restriction operator $\RnX$. Orthogonality is established with respect to the $L^2$ scalar product
%
\begin{equation*}
 \INNERIN{L^2}{f}{g} \DEFEQ \int_\RR f(x)\, \overline{g(x)}\, \D x,
\end{equation*}
%
however, the results which make sense in Banach spaces can as be generalized to $L^p$ spaces with $p \neq 2$, where 
$\INNERIN{L^2}{f}{}$ is a functional for certain $f$. The cases covered here, nearest-neighbor and linear interpolation, 
can be written as tensor products of one-dimensional interpolation in higher dimensions. Therefore, we cover only the 1D 
case. \\
%
Let $\IDX{1}{x} < \IDX{2}{x} < \dots < \IDX{n}{x}$ be a set of nodes in $\RR$. We define the help nodes $\IDX{0}{x}$ 
and $\IDX{n+1}{x}$ by symmetric continuation, \ie,
%
\begin{equation*}
 \IDX{0}{x} \DEFEQ \IDX{1}{x} - (\IDX{2}{x} - \IDX{1}{x}) = 2 \IDX{1}{x} - \IDX{2}{x}
 \quad \text{and} \quad
 \IDX{n+1}{x} \DEFEQ  2 \IDX{n}{x} - \IDX{n-1}{x}.
\end{equation*}
%
For notational reasons, we further define the distances $\IDX{i}{h} \DEFEQ \IDX{i+1}{x} - \IDX{i}{x}$ for 
$i=0,\dots,n$.


\subsubsection{Nearest-neighbor interpolation}
\label{subsubsec:specif:interp:nn}

This type of interpolation is defined by a piecewise constant interpolation basis:
%
\begin{equation*}
 \IDX{i}{\phi}(x) \DEFEQ 
 \begin{cases}
  1 & \text{if } \IDX{i}{x} - \frac{\IDX{i-1}{h}}{2} \leq x < \IDX{i}{x} + \frac{\IDX{i}{h}}{2}, \\
  0 & \text{else}.
 \end{cases}
\end{equation*}
%
It is clear that $\INNERIN{L^2}{\IDX{i}{\phi}}{\IDX{j}{\phi}} = 0$ if $i \neq j$ since the supports do not overlap. For 
the diagonal terms, we calculate
%
\begin{equation*}
 \int_\RR \ABS*{\IDX{i}{\phi}(x)}^2\, \D x 
 = \int_{\IDX{i}{x} - \frac{\IDX{i-1}{h}}{2}}^{\IDX{i}{x} + \frac{\IDX{i}{h}}{2}} 1\, \D x
 = \frac{\IDX{i-1}{h} + \IDX{i}{h}}{2} = \frac{\IDX{i+1}{x} - \IDX{i-1}{x}}{2}
 \EQDEF \IDX{i}{\bar h}
\end{equation*}
%
Hence, $\vG_\Phi = \DIAG\big( \IDX{i}{\bar h} \big)_{i=1,\dots,n}$, and the dictionary $\Theta$ with
%
\begin{equation*}
 \IDX{i}{\theta} \DEFEQ \big( \IDX{i}{\bar h} \big)^{-1}\, \IDX{i}{\phi}
\end{equation*}
%
is the unique dictionary bi-orthonormal to $\Phi$ with the same linear span. The functional 
$\INNERIN{L^2}{\IDX{i}{\theta}}{}$ is approximated as
%
\begin{align*}
 \INNERIN{L^2}{\IDX{i}{\theta}}{f}
 &= \big( \IDX{i}{\bar h} \big)^{-1} \int_{\IDX{i}{x} - \frac{\IDX{i-1}{h}}{2}}^{\IDX{i}{x} + 
 \frac{\IDX{i}{h}}{2}} \overline{f(x)}\, \D x \\
 &\approx  \frac{2}{\IDX{i+1}{x} - \IDX{i-1}{x}} \overline{f\big( \IDX{i}{x} \big)} \frac{\IDX{i-1}{h} + \IDX{i}{h}}{2} 
 \\
 &= \overline{f\big( \IDX{i}{x} \big)}
\end{align*}
%
by the rectangular (midpoint) integration rule. Thus, the collocation operator at the nodes $\IDX{i}{x}$, applied to 
$\bar f$, is an approximation to the restriction operator $\RnX$.


\subsubsection{Linear interpolation}
\label{subsubsec:specif:interp:linear}

This continuous interpolation type is defined by the piecewise linear functions 
%
\begin{equation*}
 \IDX{i}{\phi}(x) \DEFEQ
 \begin{dcases}
  \frac{x - \IDX{i-1}{x}}{\IDX{i}{x} - \IDX{i-1}{x}} & \text{if } \IDX{i-1}{x} \leq x \leq \IDX{i}{x}, \\
  \frac{\IDX{i+1}{x} - x}{\IDX{i+1}{x} - \IDX{i}{x}} & \text{if } \IDX{i}{x} \leq x \leq \IDX{i+1}{x}, \\
  0 & \text{else}.
 \end{dcases}
\end{equation*}
%
To calculate the mutual inner products of the dictionary elements, we observe that 
$\INNERIN{L^2}{\IDX{i}{\phi}}{\IDX{j}{\phi}} = 0$ if $\ABS{i-j} > 1$. For $j=i+1$, the overlap of the supports is the 
interval ${[\IDX{i}{x}, \IDX{i+1}{x}]}$, and thus
%
\begin{equation*}
 \INNERIN{L^2}{\IDX{i}{\phi}}{\IDX{i+1}{\phi}}
 = \int_\IDX{i}{x}^\IDX{i+1}{x} \frac{\IDX{i+1}{x} - x}{\IDX{i}{h}} \cdot \frac{x - \IDX{i}{x}}{\IDX{i}{h}}\, \D x
 = \frac{\IDX{i}{h}}{6}.
\end{equation*}
%
For $j=i$, we calculate
%
\begin{align*}
 \INNERIN{L^2}{\IDX{i}{\phi}}{\IDX{i}{\phi}}
 &= \int_\IDX{i-1}{x}^\IDX{i}{x} \left( \frac{x - \IDX{i-1}{x}}{\IDX{i-1}{h}} \right)^2\, \D x +
 \int_\IDX{i}{x}^\IDX{i+1}{x} \left( \frac{\IDX{i+1}{x} - x}{\IDX{i}{h}} \right)^2\, \D x \\
 &= \frac{\IDX{i-1}{h}}{3} + \frac{\IDX{i}{h}}{3} 
 = \frac{\IDX{i+1}{x} - \IDX{i-1}{x}}{3}
 = \frac{2}{3}\, \IDX{i}{\bar h}.
\end{align*}
%
Hence, $\vG_\Phi$ is a symmetric real tri-diagonal matrix with
%
\begin{equation*}
 \INNERIN{L^2}{\IDX{i}{\phi}}{\IDX{i}{\phi}} = \frac{2}{3}\, \IDX{i}{\bar h}
 \quad \text{and} \quad
 \INNERIN{L^2}{\IDX{i}{\phi}}{\IDX{i+1}{\phi}} = \frac{\IDX{i}{h}}{6}.
\end{equation*}
%
As far as the operator $\RnX$ is concerned, we write
%
\begin{align*}
 \INNERIN{L^2}{\IDX{i}{\theta}}{\bar f}
 &= \int_\RR \IDX{i}{\theta}(x)\, f(x)\, \D x \\
 & \approx \frac{1}{2}\left(
 \IDX{1}{h} \IDX{i}{\theta}(\IDX{1}{x}) f(\IDX{1}{x}) + \IDX{n}{h} \IDX{i}{\theta}(\IDX{n}{x}) f(\IDX{n}{x})  
 \right) + \phantom{x} \\
 &\hspace{10pt} \sum_{j=2}^{n-1} \IDX{j}{\bar h} \IDX{i}{\theta}(\IDX{j}{x}) f(\IDX{j}{x}).
\end{align*}
%
The function values $\IDX{i}{\theta}(\IDX{j}{x})$ for a bi-orthonormal dictionary $\Theta$ can be calculated with the 
relation
%
\begin{equation*}
 \IDX{i}{\theta}(\IDX{j}{x}) 
 = \sum_{k=1}^n \INNERIN{L^2}{\IDX{i}{\theta}}{\IDX{k}{\theta}}\, \IDX{k}{\phi}(\IDX{j}{x})
 = \INNERIN{L^2}{\IDX{i}{\theta}}{\IDX{j}{\theta}}
\end{equation*}
%
since $\IDX{k}{\phi}(\IDX{j}{x}) = \delta_{k,j}$ by construction. Hence, it is the matrix $\vG_\Theta = \vG_\Phi^{-1}$ 
that contains the coefficients $g_{i,j} = \INNERIN{L^2}{\IDX{i}{\theta}}{\IDX{j}{\theta}}$ in the approximation formula
%
\begin{align*}
 \INNERIN{L^2}{\IDX{i}{\theta}}{\bar f}
 & \approx \frac{1}{2}\left(
 \IDX{1}{h} g_{i,1} f(\IDX{1}{x}) + \IDX{n-1}{h} g_{i,n} f(\IDX{n}{x})  
 \right) + \phantom{x} \\
 &\hspace{10pt} \sum_{j=2}^{n-1} \IDX{j}{\bar h} g_{i,j} f(\IDX{j}{x}).
\end{align*}

\begin{remark}
 Numerical tests indicate that the derived formula is rather sensitive with respect to node distribution. It seems to 
 work stably for close to uniformly distributed nodes but fails for large deviations in node spacing. Thus, the 
 approximation formula is rather a theoretical result explaining the relation between the operators $\RnX$ and $\EnX$.
\end{remark}


\subsubsection{Higher-order interpolation}
\label{subsubsec:specif:interp:higher}



\subsection{Phase shift dictionary}
\label{subsec:specif:phase}



\section{Software implementation}
\label{sec:soft}



\subsection{General considerations}
\label{subsec:soft:general}
%
\textbf{Discretizations:}
A discretization $\DISCRnX = (\SPCX, \Fn, \RnX, \EnX)$ is implemented as discretized linear 
space $X_n$ in the following way:
%
\begin{itemize}
 \item $X_n$ is a (or derives from) \texttt{LinearSpace}.
 \item When initialized, it is provided with \emph{instances} of $\SPCX$ and $\Fn$.
 \item It inherits the ``intersection'' of the structure of $\SPCX$ and $\Fn$, i.e. if $\SPCX$ is a 
 \texttt{MetricSpace} and $\Fn$ a \texttt{HilbertSpace}, $X_n$ will be a \texttt{MetricSpace}.
 \item Elements in $X_n$ are created by casting $n$-tuples of elements of $\FIELD$ (given as list, array, \dots).
 \item $\RnX \colon \SPCX \to \Fn$ 
   can optionally be provided as a \texttt{LinearOperator}. If $\SPCX$ is a \texttt{FunctionSpace},
   then an element $f_n \in X_n$ can be initialized from an analytically defined function $f \in \SPCX$ 
   (i.e., a Python function) as $f_n \DEFEQ  \RnX(f)$, such as in the case of point collocation.
 \item $\EnX \colon \Fn \to \SPCX$ can optionally be provided as a \texttt{LinearOperator}. 
   If $\EnX$ is given and $\SPCX$ is a \texttt{FunctionSpace}, 
   a discretized function $f_n \in X_n$ can be evaluated at any given point, e.g., by interpolation. 
   Such an interpolation rule does in this way define a continuous function $f \in \SPCX$.
\end{itemize}
%
\textbf{Re-discretizations:}
Consider two different discretizations of a fixed vector space $\SPCX$ given by 
\[ \DISCRnX = (\SPCX, \Fn, \RnX, \EnX)
   \quad\text{and}\quad
  \DISCR{\SPCX}{m} =(\SPCX, \Fm, \RmX, \EmX)
\]  
with $X_n$ and $X_m$ as the corresponding discretized linear spaces.
The re-discreti\-zation of $\DISCRnX$ into $\DISCR{\SPCX}{m}$ is the mapping 
\[  \DISCOPID_{m,n} \colon \Fm \to \Fn
    \quad\text{defined as}\quad
    \DISCOPID_{m,n} \DEFEQ  \RmX \circ \EnX.
\]   
It is represented in the software as follows:
\begin{itemize}
 \item $\DISCOPID_{m,n}$ is a \texttt{LinearOperator}\footnote{for now, may be relaxed to \texttt{Operator}} with 
 $\mathtt{domain} = X_n$ and $\mathtt{range} = X_m$.
 \item If $\EnX$ and $\RmX$ are present in $X_n$ or $X_m$, respectively, $\DISCOPID_{m,n}$ is implemented as the 
 composition of these operators by default.
 \item A direct (optimized) implementation and can be provided, e.g., by an external software package.
\end{itemize}



\subsection{Dictionary-based discretization}
\label{subsec:soft:dict}



\subsection{Examples}
\label{subsec:soft:examp}

\begin{example}[Re-interpretation]
 Let $\bar f \in X_n = (\SPCX, \Fn, \emptyset, \emptyset)$ be represented by $\valpha \in \Fn$ and 
 $X_m = (\SPCX, \Fm, \RmX, \EmX)$ with $m=n$. Then $\bar f$ can be re-interpreted as $\bar f \in \SPCX_m$ by 
 the identity mapping $\OPID \colon X_n \to \SPCX_m$. Practically, the re-mapped element will be aware of the ``added 
 structure '' $\RmX, \EmX$.
\end{example}





% \cleardoublepage
% \appendix
% \section{Basic definitions}
% \subsection{Algebraic structures}
% We begin with the basic definition of the underlying algebraic objects, namely ring and field.
% A field is basically an abstraction of the set $\RR$ of real numbers with the ``usual'' 
% addition and multiplication.
% \begin{definition}[Ring and field]
%   A set $\FIELD$ is a \emph{ring} if there are two laws of composition
%   $(\alpha,\beta)\mapsto \alpha+\beta$ and $(\alpha,\beta) \mapsto \alpha\cdot \beta$, called 
%   respectively \emph{addition} and \emph{multiplication}, satisfying the following axioms:
%   \begin{enumerate}
%   \item $\FIELD$ is a commutative group under addition with zero element $0_{\FIELD}$, \ie,
%     the following holds for all $\alpha,\beta,\gamma\in \FIELD$:
%     \begin{enumerate}
%     \item addition is associative, \ie, $\alpha + (\beta+\gamma)=(\alpha+\beta)+\gamma$,
%     \item addition is commutative, \ie, $\alpha + \beta = \beta+\alpha$,
%     \item the zero element is the identity element \wrt the addition so 
%        $\alpha+0_{\FIELD}=0_{\FIELD}+\alpha=\alpha$,
%     \item $-\alpha$ denotes the inverse of $\alpha$  \wrt the addition so 
%        $\alpha+(-\alpha)=(-\alpha)+\alpha=0_{\FIELD}$.
%     \end{enumerate}
%   \item the multiplication is associative and possesses an identity element $1_{\FIELD}$, \ie,
%     the following holds for all $\alpha,\beta,\gamma\in \FIELD$:
%     \begin{enumerate}
%     \item multiplication is associative, \ie, 
%       $\alpha\cdot (\beta\cdot \gamma)=(\alpha\cdot \beta)\cdot \gamma$,
%    \item $1_{\FIELD}$ is the identity element \wrt the multiplication so 
%       $1_{\FIELD}\cdot \alpha=\alpha \cdot 1_{\FIELD}=\alpha$, 
%   \end{enumerate}
%   \item the multiplication is distributive with respect to the addition, \ie,
%     for all $\alpha,\beta,\gamma\in \FIELD$,
%     \[ (\alpha+\beta)\cdot \gamma = \alpha \cdot \gamma+\beta\cdot\gamma 
%        \quad\text{and}\quad
%        \alpha \cdot (\beta + \gamma) = \alpha \cdot \beta+\alpha\cdot\gamma.
%     \]
%   \end{enumerate}
%   A ring $\FIELD$ is called a \emph{field} if it does not consist only of $0_{\FIELD}$ and every non-zero 
%   element of $\FIELD$ has an inverse \wrt the multiplication. Finally, a field is \emph{commutative}
%   if its multiplication is commutative.
% \end{definition}
% When working with fields we will simplify the notational burden by not explicitly writing 
% the multiplication $\cdot$, \ie, $\alpha \beta$ means $\alpha\cdot\beta$ whenever 
% $\alpha,\beta\in\FIELD$. Moreover, we will write $1$ and $0$ instead of $1_{\FIELD}$ and $0_{\FIELD}$.
% Having defined the concept of a field, we are now ready to define the concept of a vector 
% space.
% \begin{definition}[Vector space]
%   Let $\FIELD$ be a fixed field. Then a set $X$ is a \emph{left vector space over $\FIELD$} if 
%   $X$ is a commutative group (the group law will be written additively in what follows)
%   together with a map  $(\alpha,x) \mapsto \alpha\cdot x$, called the \emph{vector space 
%   multiplication}, where
%   \begin{enumerate}
%   \item $\alpha \cdot (x+y)=\alpha \cdot x+\alpha \cdot y$
%      for all $\alpha\in \FIELD$ and $x,y\in X$,
%   \item $(\alpha + \beta) \cdot x= \alpha \cdot x + \beta\cdot x$ 
%      for all $\alpha, \beta\in \FIELD$ and $x\in X$,\label{MII}
%   \item $\alpha \cdot (\beta \cdot x) = (\alpha\beta)\cdot x$  
%      for all $\alpha, \beta\in \FIELD$ and $x\in X$,\label{MIII}
%   \item $1\cdot x = x$ for all $x\in X$.
%   \end{enumerate}
%   If \eqref{MIII} above is replaced by the axiom
%   \[ \alpha \cdot (\beta \cdot x) = (\beta \alpha)\cdot x
%         \quad\text{for all $\alpha, \beta\in \FIELD$ and $x\in X$,}
%   \]
%   then we say that $X$ is a \emph{right vector space over $\FIELD$}. Elements in the 
%   field $\FIELD$ are called \emph{scalars} and elements in $X$ are called \emph{vectors}. 
%   Finally,  note that in \eqref{MII} above, the addition $+$ in the left hand side 
%   represents the addition in 
%   the field $\FIELD$, whereas in the right hand side it represents the group law in $X$.
% \end{definition}  
% We say that a subset $V \subset X$ is a \emph{vector subspace of $X$} if $V$ itself is a vector 
% space over $\FIELD$ with the same operations as in $X$. This is equivalent to requiring that 
% $0\in V$ and $\alpha x, x+y \in V$ whenever $x,y\in V$ and $\alpha \in \FIELD$.
% 
% Often the vector space multiplication $\cdot$ is not written explicitly. In fact, if $X$ is a 
% left (resp.\@ right) vector space over a field $\FIELD$, then any expression of the type 
% $\alpha x$ where $\alpha\in\FIELD$ and $x\in X$ means $\alpha \cdot x$. Moreover, we will not 
% notationally distinguish between the addition in $\FIELD$ and the group law in $X$, so 
% $\alpha + \beta$ refers to the addition in $\FIELD$ if $\alpha,\beta\in \FIELD$ and to the group law in 
% $X$ if $\alpha,\beta\in X$. In the same way we do not notationally distinguish between the 
% zero in $X$ and the zero in $\FIELD$
% 
% Having dealt with the notational conventions, let us now proceed by defining concepts such 
% as linear combination, basis, and dimension.
% \begin{definition}[Linear combination and independence]
%    Let $X$ be a right (resp.\@ left) vector space over a field $\FIELD$. Also, 
%    let $\{ v_1, \dots, v_{n} \}  \subset X$ be a fixed subset. An element $x\in X$ 
%    is said to be a \emph{linear combination of the elements $\{ v_1, \dots, v_{n} \}$} if 
%    there exists a subset $\{ \alpha_1,\dots,\alpha_{n} \} \subset \FIELD$ such that 
%    \[  x= \alpha_1 v_1 + \dots +  \alpha_{n} v_{n}. \]
%    The elements $\{ \alpha_1,\dots,\alpha_{n} \}$ are then called the \emph{coefficients 
%   (or coordinates)  of $x$ \wrt $\{ v_1, \dots, v_{n} \}$}. Moreover, we say that this finite 
%   set is \emph{linearly independent} if 
%    \[ \alpha_1 v_1 + \dots + \alpha_{n} v_{n} =0
%       \quad\text{implies that}\quad \alpha_1=\dots=\alpha_{n}=0. \]
%   Note that the zero in the left hand side is the zero vector in $X$ whereas the zero in the right 
%   hand side is the zero in the field $\FIELD$.
% \end{definition}
% Using the axiom of choice, one can show, see, \eg, Chapter~II, section~7 in \cite{Bo89}, 
% that every vector space $X$ has a maximal linearly independent subset $B \subset X$ 
% spanning $X$, \ie, every vector $x\in X$ can be written as a finite linear combination 
% of the elements in $B$. Such a maximal subset is called a \emph{(Hamel) basis}. If 
% $B$ denotes a basis of the vector space $X$, then any element $x\in X$ has a 
% unique representation as a linear combination of vectors $v_1,\dots,v_{n}\in B$, \ie, there 
% exists unique scalars $\alpha_1,\dots,\alpha_{n}\in\FIELD$ such that 
% \[ x = \alpha_1 v_1 + \dots + \alpha_{n} v_{n}. \]
% The scalars $\alpha_1,\dots,\alpha_{n}$ are then called the  \emph{coordinates/coefficients}
% of $x$ with respect to the basis $B$. The \emph{dimension} of $X$ is defined as the cardinality 
% of its Hamel basis. Since one can show that any two Hamel basis of $X$ 
% have the same cardinality, the concept of dimension is well-defined.
% \begin{definition}[Linear map]
%   Let $X$ and $Y$ be two (left) vector spaces over the same field $\FIELD$. A map
%   $f \colon X \to Y$ is called a \emph{linear map (homomorphism)} if
%   \[  f(x+y)=f(x)+f(y) \quad\text{and}\quad
%       f(\alpha x)=\alpha f(x)  \]
%   for all $x,y\in X$ and $\alpha\in \FIELD$.
%   Note that $\alpha x$ refers to the vector space multiplication in $X$, whereas $\alpha f(x)$
%   refers to the vector space multiplication in $Y$.
%   If $X$ and $Y$ are two (right) vector spaces over the same field $\FIELD$, then we need to
%   replace the condition $f(\alpha x)=\alpha f(x)$ with $f(x\alpha)= f(x) \alpha$.
%   Finally,  we let  $\Hom_{\FIELD}(X,Y)$ denote the set of linear mappings from $X$ into $Y$.
% \end{definition}   
% Since any result that holds for left vector spaces over $\FIELD$ also holds for right vector spaces 
% over $\FIELD$, we shall in the sequel we shall drop the prefix left (resp.\@ right). Moreover, if
% the field is commutative, then there is no difference in the sense that any left vector spaces
% is also a right vector spaces.
% 
% An important class of vector spaces are the product spaces. 
% If $X_1, \dots, \Fn$ are  vector spaces over the same field $\FIELD$, then we
% define the \emph{product space}
% \begin{equation}\label{eq:ProdSpace}
%    X\DEFEQ  X_1 \times \dots  \times \Fn 
% \end{equation}
% as the set of elements $(x_1,\dots,x_{n})$ where $x_i\in X_i$. There is a natural vector 
% space structure on $X$, namely, if $(x_1,\dots,x_{n}), (y_1,\dots,y_{n})\in X$ and 
% $\alpha\in\FIELD$, then 
% \begin{align*}
%    (x_1,\dots,x_{n})+(y_1,\dots,y_{n}) &\DEFEQ  (x_1+y_1,\dots,x_{n}+y_{n}) \\
%    \alpha (x_1,\dots,x_{n}) &\DEFEQ  (\alpha x_1,\dots,\alpha x_{n}).
% \end{align*}
% Note that $x_i+y_i$ and $\alpha x_i$ refer to the group law and vector space 
% multiplication in the vector space $X_i$. It is easy to show that with the above definitions, 
% $X$ becomes a vector space over $\FIELD$. 
% For notational simplicity, in many cases one would like to simplify the notation for
% elements in a product space $X$. 
% %In fact, we will denote such elements by the corresponding 
% %bold face letter, \ie, $(x_1,\dots,x_{n})$ is denoted 
% %by $\bx$ and $(y_1,\dots,y_{n})$ by $\by$, \etc Thus, with this notational convention 
% %$\bx_i$ refers to an element in the product space $X$ that is indexed by $i$ and 
% %$x_i$ refers to the corresponding element in $X_i$ of $\bx=(x_1,\dots,x_{n})$. 
% 
% Now, if $X$ is a product space defined as in \eqref{eq:ProdSpace}, then the 
% \emph{natural projections}
% \[ \pi_i \colon X \to X_i \quad\text{are defined as}\quad \pi_i(x)\DEFEQ x_i, \]
% and they are surjective linear mappings, \ie, $\pi_i\in\Hom_{\FIELD}(X,X_i)$. 
% Now, it is easy to show, see, \eg, Proposition~4, Section~1.5, Chapter~II in \cite{Bo89}, 
% that for any vector space $Y$ over $\FIELD$ and any finite set of linear mappings 
% $f_i \in \Hom_{\FIELD}(Y,X_i)$,  $i=1,\dots,n$, there exists a unique map 
% $f\in \Hom_{\FIELD}(Y,X)$ such that 
% \[ \pi_i \circ f = f_i. \]
% Conversely, given $f\in \Hom_{\FIELD}(Y,X)$, we can always define $f_i \in \Hom_{\FIELD}(Y,X_i)$ by 
% the above relation. 
% %We will use the bold face notation $\vf$ on the elements in $\Hom_{\FIELD}(Y,X)$
% %\emph{only} when there is an explicit need to refer to the $f_i$:s.
% 
% We will finally define the concepts of norm and inner product for vector spaces over $\RR$ 
% or $\CC$. 
% \begin{definition}[Norm and inner product]
%   Let $\FIELD$ be a field of real numbers $\RR$ or complex numbers $\CC$  with the usual 
%   addition and multiplication. Moreover, let $X$ be a vector space over $\FIELD$. A mapping 
%   \[ \Vert \cdot \Vert \colon X \to [0,\infty[ \]
%   is called a \emph{norm on $X$} if the following holds for all $x,y \in X$ and $\alpha\in\FIELD$:
%   \begin{enumerate}
%   \item $\Vert \alpha x \Vert = \vert \alpha \vert \, \Vert x \Vert$,
%   \item $\Vert x \Vert \geq 0$ with equality if and only if $x$ is the zero element in $X$,
%   \item $\Vert x+y \Vert \leq \Vert x \Vert+\Vert y \Vert$.
%   \end{enumerate}
%   A mapping 
%   \[ \ip{\cdot}{\cdot} \colon X\times X \to \FIELD \]
%   is called the \emph{inner product on $X$}
%   if the following holds for all $x,y,z \in X$ and $\alpha\in\FIELD$:
%   \begin{enumerate}
%   \item $\ip{x}{y}=\overline{\ip{y}{x}}$,
%   \item $\ip{\alpha x}{y}=\overline{\alpha}\ip{x}{y}$ and $\ip{x}{\alpha  y}= \alpha \ip{x}{y}$,
%   \item $\ip{x + y}{z} = \ip{x}{z}  +  \ip{y}{z}$,
%   \item  $\ip{x}{x}\geq 0$ with equality if and only if $x$ is the zero element in $X$.
%   \end{enumerate}
%   A vector space with an inner product is called an \emph{inner product (or pre Hilbert) space}
%   and a vector space with a norm is called a \emph{normed space}.
% \end{definition}
% Let $X$ be an inner product space. Then we say that $x,y \in X$ are \emph{orthogonal} 
% if $\ip{x}{y}=0$. 
% 
% 
% \paragraph{Examples of vector spaces.}
% The first example is a trivial one, namely that any field $\FIELD$ is a one-dimensional 
% vector space over itself. The next example is the product space $\Fn$ which is  defined as 
% the $n$ fold product of $\FIELD$, \ie,
% \[ \Fn \DEFEQ  \underbrace{\FIELD \times \dots \times \FIELD}_{\text{$n$ times}}. \]
% Then $\Fn$ is an $n$-dimensional vector space 
% over $\FIELD$. In this setting, $\FIELD^1$ is isomorphic to $\FIELD$, so we will identify $\FIELD^1$ with $\FIELD$
% without further notice. The importance of the vector space $\Fn$ originates from the fact 
% that it is the canonical $n$-dimensional vector space. In fact, any $n$-dimensional vector 
% space $X$ can be naturally identified 
% with $\Fn$. Let  $\{ v_1,\dots, v_{n} \}$ be a basis of $X$ and define the map 
% $\phi \colon X \to \Fn$ as
% \[  \phi\Bigl( \sum_{i=1}^n \alpha_i v_i \Bigr) \DEFEQ  (\alpha_1,\dots,\alpha_{n})\in\Fn
%     \quad\text{so}\quad 
%     \phi^{-1}(\alpha_1,\dots,\alpha_{n}) = \sum_{i=1}^n \alpha_i v_i.
% \]
% The above map $\phi$ is an vector space isomorphism which we call the \emph{natural 
% isomorphism of $X$ \wrt the basis $\{ v_1,\dots, v_{n} \}$}, so $X$ is isomorphic to $\Fn$.
% Let us also mention that in order to comply with the notation used in 
% matrix algebra\footnote{Matrix, and more generally, tensor algebra for matrices and tensors with 
% elements in a general field $\FIELD$ is a straightforward generalization of the matrix and 
% tensor algebra for matrices and tensors with elements in $\RR$. 
% We refer to \cite[Chapter~II, Section~10 and Chapter~III]{Bo89} for the formal details.} 
% in $\FIELD$, a vector $\alpha\in\Fn$ is written as a column vector of its components, 
% \ie,
% \[ \alpha = \begin{pmatrix} \alpha_1 \\  \vdots \\  \alpha_{n} \end{pmatrix}
%    \quad\text{with $\alpha_j \in \FIELD $ for $j=1,\dots,n$.}
% \]
% 
% As a final example,  let $X$ be a set and $Y$ a vector space over a field $\FIELD$. Now, the 
% set $\Map(X,Y)$ of all mappings from $X$ into $Y$ has a natural vector space 
% structure. In fact, for $f,g\in \Map(X,Y)$ and $\alpha\in\FIELD$ we define $f+g$ and $\alpha f$ as 
% \[ (f+g)(x)\DEFEQ  f(x)+g(x) \quad\text{and}\quad (\alpha f)(x)\DEFEQ \alpha f(x) \]
% for all $x\in X$. Then, whenever $f+g, \alpha f\in  \Map(X,Y)$, the set $\Map(X,Y)$ becomes
% a vector space over $\FIELD$ under the above definitions of the group law and vector space 
% multiplication. An interesting special case is when $X$ is a vector space over $\FIELD$ and 
% $\Map(X,Y)= \Hom_{\FIELD}(X,Y)$.


%\subsection{Topological structures}
%Let $\FIELD$ denote the field of real numbers $\RR$ or complex numbers $\CC$ with the usual
%addition and multiplication. 

\bibliographystyle{plain}
\bibliography{discretization}

\end{document}
